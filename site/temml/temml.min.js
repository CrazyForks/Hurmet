var temml=function(){"use strict";class e{constructor(t,r){let n="Temml parse error: "+t;let s;const o=r&&r.loc;if(o&&o.start<=o.end){const e=o.lexer.input;s=o.start;const t=o.end;if(s===e.length){n+=" at end of input: "}else{n+=" at position "+(s+1)+": "}const r=e.slice(s,t).replace(/[^]/g,"$&̲");let a;if(s>15){a="…"+e.slice(s-15,s)}else{a=e.slice(0,s)}let i;if(t+15<e.length){i=e.slice(t,t+15)+"…"}else{i=e.slice(t)}n+=a+r+i}const a=new Error(n);a.name="ParseError";a.__proto__=e.prototype;a.position=s;return a}}e.prototype.__proto__=Error.prototype;const t=function(e,t){return e.indexOf(t)!==-1};const r=function(e,t){return e===undefined?t:e};const n=/([A-Z])/g;const s=function(e){return e.replace(n,"-$1").toLowerCase()};const o={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"};const a=/[&><"']/g;function i(e){return String(e).replace(a,(e=>o[e]))}const l=function(e){if(e.type==="ordgroup"){if(e.body.length===1){return l(e.body[0])}else{return e}}else if(e.type==="color"){if(e.body.length===1){return l(e.body[0])}else{return e}}else if(e.type==="font"){return l(e.body)}else{return e}};const u=function(e){const t=l(e);return t.type==="mathord"||t.type==="textord"||t.type==="atom"};const c=function(e){if(!e){throw new Error("Expected non-null, but got "+String(e))}return e};const m=function(e){const t=/^\s*([^\\/#]*?)(?::|&#0*58|&#x0*3a)/i.exec(e);return t!=null?t[1]:"_relative"};const p=function(e){return+e.toFixed(4)};var d={contains:t,deflt:r,escape:i,hyphenate:s,getBaseElem:l,isCharacterBox:u,protocolFromUrl:m,round:p};class h{constructor(e){e=e||{};this.displayMode=d.deflt(e.displayMode,false);this.leqno=d.deflt(e.leqno,false);this.errorColor=d.deflt(e.errorColor,"#b22222");this.macros=e.macros||{};this.strict=d.deflt(e.strict,false);this.trust=d.deflt(e.trust,false);this.maxSize=Math.max(0,d.deflt(e.maxSize,Infinity));this.maxExpand=Math.max(0,d.deflt(e.maxExpand,1e3))}reportNonstrict(t,r,n){const s=this.strict;if(s===false){return}else if(s===true){throw new e("LaTeX-incompatible input and strict mode is set to 'error': "+`${r} [${t}]`,n)}else if(s==="warn"){typeof console!=="undefined"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+`${r} [${t}]`)}else{return}}isTrusted(e){if(e.url&&!e.protocol){e.protocol=d.protocolFromUrl(e.url)}const t=typeof this.trust==="function"?this.trust(e):this.trust;return Boolean(t)}}const g={};const f={};function b({type:e,names:t,props:r,handler:n,mathmlBuilder:s}){const o={type:e,numArgs:r.numArgs,argTypes:r.argTypes,allowedInArgument:!!r.allowedInArgument,allowedInText:!!r.allowedInText,allowedInMath:r.allowedInMath===undefined?true:r.allowedInMath,numOptionalArgs:r.numOptionalArgs||0,infix:!!r.infix,primitive:!!r.primitive,handler:n};for(let e=0;e<t.length;++e){g[t[e]]=o}if(e){if(s){f[e]=s}}}function y({type:e,mathmlBuilder:t}){b({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},mathmlBuilder:t})}const w=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e};const x=function(e){return e.type==="ordgroup"?e.body:[e]};class k{constructor(e){this.children=e;this.classes=[];this.style={}}hasClass(e){return d.contains(this.classes,e)}toNode(){const e=document.createDocumentFragment();for(let t=0;t<this.children.length;t++){e.appendChild(this.children[t].toNode())}return e}toMarkup(){let e="";for(let t=0;t<this.children.length;t++){e+=this.children[t].toMarkup()}return e}toText(){const e=e=>e.toText();return this.children.map(e).join("")}}const A=function(e){return e.filter((e=>e)).join(" ")};const v=function(e,t){this.classes=e||[];this.attributes={};this.style=t||{}};const T=function(e){const t=document.createElement(e);t.className=A(this.classes);for(const e in this.style){if(this.style.hasOwnProperty(e)){t.style[e]=this.style[e]}}for(const e in this.attributes){if(this.attributes.hasOwnProperty(e)){t.setAttribute(e,this.attributes[e])}}for(let e=0;e<this.children.length;e++){t.appendChild(this.children[e].toNode())}return t};const N=function(e){let t=`<${e}`;if(this.classes.length){t+=` class="${d.escape(A(this.classes))}"`}let r="";for(const e in this.style){if(this.style.hasOwnProperty(e)){r+=`${d.hyphenate(e)}:${this.style[e]};`}}if(r){t+=` style="${d.escape(r)}"`}for(const e in this.attributes){if(this.attributes.hasOwnProperty(e)){t+=` ${e}="${d.escape(this.attributes[e])}"`}}t+=">";for(let e=0;e<this.children.length;e++){t+=this.children[e].toMarkup()}t+=`</${e}>`;return t};class S{constructor(e,t){v.call(this,e);this.children=t||[]}setAttribute(e,t){this.attributes[e]=t}toNode(){return T.call(this,"span")}toMarkup(){return N.call(this,"span")}}class q{constructor(e){this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return d.escape(this.text)}}class M{constructor(e,t,r){this.alt=t;this.src=e;this.classes=["mord"];this.style=r}hasClass(e){return d.contains(this.classes,e)}toNode(){const e=document.createElement("img");e.src=this.src;e.alt=this.alt;e.className="mord";for(const t in this.style){if(this.style.hasOwnProperty(t)){e.style[t]=this.style[t]}}return e}toMarkup(){let e=`<img  src='${this.src} 'alt='${this.alt}' `;let t="";for(const e in this.style){if(this.style.hasOwnProperty(e)){t+=`${d.hyphenate(e)}:${this.style[e]};`}}if(t){e+=` style="${d.escape(t)}"`}e+="'/>";return e}}function B(e){return new k(e)}class O{constructor(e,t,r,n){this.type=e;this.attributes={};this.children=t||[];this.classes=r||[];this.isSVG=n||false}setAttribute(e,t){this.attributes[e]=t}getAttribute(e){return this.attributes[e]}toNode(){const e=this.isSVG?document.createElementNS("http://www.w3.org/2000/svg",this.type):document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(const t in this.attributes){if(Object.prototype.hasOwnProperty.call(this.attributes,t)){e.setAttribute(t,this.attributes[t])}}if(this.classes.length>0){e.className=A(this.classes)}for(let t=0;t<this.children.length;t++){e.appendChild(this.children[t].toNode())}return e}toMarkup(){let e="<"+this.type;for(const t in this.attributes){if(Object.prototype.hasOwnProperty.call(this.attributes,t)){e+=" "+t+'="';e+=d.escape(this.attributes[t]);e+='"'}}if(this.classes.length>0){e+=` class ="${d.escape(A(this.classes))}"`}e+=">";for(let t=0;t<this.children.length;t++){e+=this.children[t].toMarkup()}e+="</"+this.type+">";return e}toText(){return this.children.map((e=>e.toText())).join("")}}class C{constructor(e){this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return d.escape(this.toText())}toText(){return this.text}}var E={MathNode:O,TextNode:C,newDocumentFragment:B};const I=["overlinesegment","underlinesegment","longRightleftharpoons","longLeftrightharpoons"];const $={widehat:"^",widecheck:"ˇ",widetilde:"~",wideparen:"⏜",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",overparen:"⏜",undergroup:"⏡",underparen:"⏝",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",longleftrightarrows:"⇄",longrightleftharpoons:"⇌","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="};const z={overlinesegment:{minWidth:.888,height:.522},underlinesegment:{minWidth:.888,height:.522},longRightleftharpoons:{minWidth:1.75,height:.716},longLeftrightharpoons:{minWidth:1.75,height:.716}};const D={linesegmentLeft:`M50 290 V428 H0 V94 H50 V240 H400000 v50z\n  M50 290 V428 H0 V94 H50 V240 H400000 v50z`,linesegmentRight:`M399950 240 V94 h50 V428 h-50 V290 H0 v-50z\n  M399950 240 V94 h50 V428 h-50 V290 H0 v-50z`};const L=(e,t)=>{e.setAttribute("xmlns","http://www.w3.org/2000/svg");e.setAttribute("width","400em");e.setAttribute("height",z[t].height+"em");e.setAttribute("viewBox",`0 0 400000 ${1e3*z[t].height}`);e.setAttribute("preserveAspectRatio","xMinYMin slice");e.setAttribute("fill","currentColor");e.setAttribute("fill-rule","non-zero");e.setAttribute("fill-opacity","1");return e};const F=(e,t)=>{const r=new E.MathNode("path",[],[],true);r.setAttribute("stroke","none");const n=e==="overlinesegment"||e==="underlinesegment"?D["linesegmentLeft"]:t.get(e+"Left");r.setAttribute("d",n);const s=new E.MathNode("path",[],[],true);s.setAttribute("stroke","none");const o=e==="overlinesegment"||e==="underlinesegment"?D["linesegmentRight"]:t.get(e+"Right");s.setAttribute("d",o);let a=new E.MathNode("svg",[r],[],true);a=L(a,e);a.setAttribute("style","position: absolute; left:0;");let i=new E.MathNode("svg",[s],[],true);i=L(i,e);i.setAttribute("style","position: absolute; right:0");const l=z[e].height;const u=new S([],[a]);u.setAttribute("style",`position: absolute; left: 0; width: 50.2%; height: ${l}em; overflow: hidden;`);const c=new S([],[i]);c.setAttribute("style",`position: absolute; right: 0; width: 50.2%; height: ${l}em; overflow: hidden;`);const m=new S([],[u,c]);m.setAttribute("style",`display: block; position: relative; width: 100%; height: ${l}em;\nmin-width: ${z[e].minWidth}em;`);return m};const G=function(e,t){const r=e.slice(1);const n=d.contains(I,r)?F(r,t):new E.TextNode($[r]);const s=new E.MathNode("mo",[n]);s.setAttribute("stretchy","true");return s};var P={mathMLnode:G};const U={bin:1,close:1,inner:1,open:1,punct:1,rel:1};const R={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1};const V={math:{},text:{}};function _(e,t,r,n,s){V[e][n]={group:t,replace:r};if(s&&r){V[e][r]=V[e][n]}}const H="math";const j="text";const X="accent-token";const W="bin";const Y="close";const Z="inner";const J="mathord";const K="op-token";const Q="open";const ee="punct";const te="rel";const re="spacing";const ne="textord";_(H,te,"≡","\\equiv",true);_(H,te,"≺","\\prec",true);_(H,te,"≻","\\succ",true);_(H,te,"∼","\\sim",true);_(H,te,"⟂","\\perp",true);_(H,te,"⪯","\\preceq",true);_(H,te,"⪰","\\succeq",true);_(H,te,"≃","\\simeq",true);_(H,te,"|","\\mid",true);_(H,te,"≪","\\ll",true);_(H,te,"≫","\\gg",true);_(H,te,"≍","\\asymp",true);_(H,te,"∥","\\parallel");_(H,te,"⋈","\\bowtie",true);_(H,te,"⌣","\\smile",true);_(H,te,"⊑","\\sqsubseteq",true);_(H,te,"⊒","\\sqsupseteq",true);_(H,te,"≐","\\doteq",true);_(H,te,"⌢","\\frown",true);_(H,te,"∋","\\ni",true);_(H,te,"∌","\\notni",true);_(H,te,"∝","\\propto",true);_(H,te,"⊢","\\vdash",true);_(H,te,"⊣","\\dashv",true);_(H,te,"∋","\\owns");_(H,te,"≘","\\arceq",true);_(H,te,"≙","\\wedgeq",true);_(H,te,"≚","\\veeeq",true);_(H,te,"≛","\\stareq",true);_(H,te,"≝","\\eqdef",true);_(H,te,"≞","\\measeq",true);_(H,te,"≟","\\questeq",true);_(H,te,"≠","\\ne",true);_(H,te,"≠","\\neq");_(H,te,"∷","\\dblcolon",true);_(H,te,"≔","\\coloneqq",true);_(H,te,"≕","\\eqqcolon",true);_(H,te,"∹","\\eqcolon",true);_(H,te,"⩴","\\Coloneqq",true);_(H,ee,".","\\ldotp");_(H,ee,"·","\\cdotp");_(H,ne,"#","\\#");_(j,ne,"#","\\#");_(H,ne,"&","\\&");_(j,ne,"&","\\&");_(H,ne,"ℵ","\\aleph",true);_(H,ne,"∀","\\forall",true);_(H,ne,"ℏ","\\hbar",true);_(H,ne,"∃","\\exists",true);_(H,ne,"∇","\\nabla",true);_(H,ne,"♭","\\flat",true);_(H,ne,"ℓ","\\ell",true);_(H,ne,"♮","\\natural",true);_(H,ne,"♣","\\clubsuit",true);_(H,ne,"♧","\\varclubsuit",true);_(H,ne,"℘","\\wp",true);_(H,ne,"♯","\\sharp",true);_(H,ne,"♢","\\diamondsuit",true);_(H,ne,"♦","\\vardiamondsuit",true);_(H,ne,"ℜ","\\Re",true);_(H,ne,"♡","\\heartsuit",true);_(H,ne,"♥","\\varheartsuit",true);_(H,ne,"ℑ","\\Im",true);_(H,ne,"♠","\\spadesuit",true);_(H,ne,"♤","\\varspadesuit",true);_(j,ne,"§","\\S",true);_(j,ne,"¶","\\P",true);_(j,ne,"☺","\\smiley");_(H,ne,"☺","\\smiley",true);_(H,ne,"†","\\dag");_(j,ne,"†","\\dag");_(j,ne,"†","\\textdagger");_(H,ne,"‡","\\ddag");_(j,ne,"‡","\\ddag");_(j,ne,"‡","\\textdaggerdbl");_(H,Y,"⎱","\\rmoustache",true);_(H,Q,"⎰","\\lmoustache",true);_(H,Y,"⟯","\\rgroup",true);_(H,Q,"⟮","\\lgroup",true);_(H,W,"∓","\\mp",true);_(H,W,"⊖","\\ominus",true);_(H,W,"⊎","\\uplus",true);_(H,W,"⊓","\\sqcap",true);_(H,W,"∗","\\ast");_(H,W,"⊔","\\sqcup",true);_(H,W,"◯","\\bigcirc",true);_(H,W,"∙","\\bullet");_(H,W,"‡","\\ddagger");_(H,W,"≀","\\wr",true);_(H,W,"⨿","\\amalg");_(H,W,"&","\\And");_(H,te,"⟵","\\longleftarrow",true);_(H,te,"⇐","\\Leftarrow",true);_(H,te,"⟸","\\Longleftarrow",true);_(H,te,"⟶","\\longrightarrow",true);_(H,te,"⇒","\\Rightarrow",true);_(H,te,"⟹","\\Longrightarrow",true);_(H,te,"↔","\\leftrightarrow",true);_(H,te,"⟷","\\longleftrightarrow",true);_(H,te,"⇔","\\Leftrightarrow",true);_(H,te,"⟺","\\Longleftrightarrow",true);_(H,te,"↦","\\mapsto",true);_(H,te,"⟼","\\longmapsto",true);_(H,te,"↗","\\nearrow",true);_(H,te,"↩","\\hookleftarrow",true);_(H,te,"↪","\\hookrightarrow",true);_(H,te,"↘","\\searrow",true);_(H,te,"↼","\\leftharpoonup",true);_(H,te,"⇀","\\rightharpoonup",true);_(H,te,"↙","\\swarrow",true);_(H,te,"↽","\\leftharpoondown",true);_(H,te,"⇁","\\rightharpoondown",true);_(H,te,"↖","\\nwarrow",true);_(H,te,"⇌","\\rightleftharpoons",true);_(H,J,"↯","\\lightning",true);_(H,te,"≮","\\nless",true);_(H,te,"⪇","\\lneq",true);_(H,te,"≨","\\lneqq",true);_(H,te,"≨︀","\\lvertneqq");_(H,te,"⋦","\\lnsim",true);_(H,te,"⪉","\\lnapprox",true);_(H,te,"⊀","\\nprec",true);_(H,te,"⋠","\\npreceq",true);_(H,te,"⋨","\\precnsim",true);_(H,te,"⪹","\\precnapprox",true);_(H,te,"≁","\\nsim",true);_(H,te,"∤","\\nmid",true);_(H,te,"∤","\\nshortmid");_(H,te,"⊬","\\nvdash",true);_(H,te,"⊭","\\nvDash",true);_(H,te,"⋪","\\ntriangleleft");_(H,te,"⋬","\\ntrianglelefteq",true);_(H,te,"⊊","\\subsetneq",true);_(H,te,"⊊︀","\\varsubsetneq");_(H,te,"⫋","\\subsetneqq",true);_(H,te,"⫋︀","\\varsubsetneqq");_(H,te,"≯","\\ngtr",true);_(H,te,"⪈","\\gneq",true);_(H,te,"≩","\\gneqq",true);_(H,te,"≩︀","\\gvertneqq");_(H,te,"⋧","\\gnsim",true);_(H,te,"⪊","\\gnapprox",true);_(H,te,"⊁","\\nsucc",true);_(H,te,"⋡","\\nsucceq",true);_(H,te,"⋩","\\succnsim",true);_(H,te,"⪺","\\succnapprox",true);_(H,te,"≆","\\ncong",true);_(H,te,"∦","\\nparallel",true);_(H,te,"∦","\\nshortparallel");_(H,te,"⊯","\\nVDash",true);_(H,te,"⋫","\\ntriangleright");_(H,te,"⋭","\\ntrianglerighteq",true);_(H,te,"⊋","\\supsetneq",true);_(H,te,"⊋","\\varsupsetneq");_(H,te,"⫌","\\supsetneqq",true);_(H,te,"⫌︀","\\varsupsetneqq");_(H,te,"⊮","\\nVdash",true);_(H,te,"⪵","\\precneqq",true);_(H,te,"⪶","\\succneqq",true);_(H,W,"⊴","\\unlhd");_(H,W,"⊵","\\unrhd");_(H,te,"↚","\\nleftarrow",true);_(H,te,"↛","\\nrightarrow",true);_(H,te,"⇍","\\nLeftarrow",true);_(H,te,"⇏","\\nRightarrow",true);_(H,te,"↮","\\nleftrightarrow",true);_(H,te,"⇎","\\nLeftrightarrow",true);_(H,te,"△","\\vartriangle");_(H,ne,"ℏ","\\hslash");_(H,ne,"▽","\\triangledown");_(H,ne,"◊","\\lozenge");_(H,ne,"Ⓢ","\\circledS");_(H,ne,"®","\\circledR",true);_(j,ne,"®","\\circledR");_(j,ne,"®","\\textregistered");_(H,ne,"∡","\\measuredangle",true);_(H,ne,"∄","\\nexists");_(H,ne,"℧","\\mho");_(H,ne,"Ⅎ","\\Finv",true);_(H,ne,"⅁","\\Game",true);_(H,ne,"‵","\\backprime");_(H,ne,"▲","\\blacktriangle");_(H,ne,"▼","\\blacktriangledown");_(H,ne,"■","\\blacksquare");_(H,ne,"⧫","\\blacklozenge");_(H,ne,"★","\\bigstar");_(H,ne,"∢","\\sphericalangle",true);_(H,ne,"∁","\\complement",true);_(H,ne,"ð","\\eth",true);_(j,ne,"ð","ð");_(H,ne,"╱","\\diagup");_(H,ne,"╲","\\diagdown");_(H,ne,"□","\\square");_(H,ne,"□","\\Box");_(H,ne,"◊","\\Diamond");_(H,ne,"¥","\\yen",true);_(j,ne,"¥","\\yen",true);_(H,ne,"✓","\\checkmark",true);_(j,ne,"✓","\\checkmark");_(j,ne,"•","\\textbullet");_(H,ne,"ℶ","\\beth",true);_(H,ne,"ℸ","\\daleth",true);_(H,ne,"ℷ","\\gimel",true);_(H,ne,"ϝ","\\digamma",true);_(H,ne,"ϰ","\\varkappa");_(H,Q,"⌜","\\ulcorner",true);_(H,Y,"⌝","\\urcorner",true);_(H,Q,"⌞","\\llcorner",true);_(H,Y,"⌟","\\lrcorner",true);_(H,te,"≦","\\leqq",true);_(H,te,"⩽","\\leqslant",true);_(H,te,"⪕","\\eqslantless",true);_(H,te,"≲","\\lesssim",true);_(H,te,"⪅","\\lessapprox",true);_(H,te,"≊","\\approxeq",true);_(H,W,"⋖","\\lessdot");_(H,te,"⋘","\\lll",true);_(H,te,"≶","\\lessgtr",true);_(H,te,"⋚","\\lesseqgtr",true);_(H,te,"⪋","\\lesseqqgtr",true);_(H,te,"≑","\\doteqdot");_(H,te,"≓","\\risingdotseq",true);_(H,te,"≒","\\fallingdotseq",true);_(H,te,"∽","\\backsim",true);_(H,te,"⋍","\\backsimeq",true);_(H,te,"⫅","\\subseteqq",true);_(H,te,"⋐","\\Subset",true);_(H,te,"⊏","\\sqsubset",true);_(H,te,"≼","\\preccurlyeq",true);_(H,te,"⋞","\\curlyeqprec",true);_(H,te,"≾","\\precsim",true);_(H,te,"⪷","\\precapprox",true);_(H,te,"⊲","\\vartriangleleft");_(H,te,"⊴","\\trianglelefteq");_(H,te,"⊨","\\vDash",true);_(H,te,"⊪","\\Vvdash",true);_(H,te,"⌣","\\smallsmile");_(H,te,"⌢","\\smallfrown");_(H,te,"≏","\\bumpeq",true);_(H,te,"≎","\\Bumpeq",true);_(H,te,"≧","\\geqq",true);_(H,te,"⩾","\\geqslant",true);_(H,te,"⪖","\\eqslantgtr",true);_(H,te,"≳","\\gtrsim",true);_(H,te,"⪆","\\gtrapprox",true);_(H,W,"⋗","\\gtrdot");_(H,te,"⋙","\\ggg",true);_(H,te,"≷","\\gtrless",true);_(H,te,"⋛","\\gtreqless",true);_(H,te,"⪌","\\gtreqqless",true);_(H,te,"≖","\\eqcirc",true);_(H,te,"≗","\\circeq",true);_(H,te,"≜","\\triangleq",true);_(H,te,"∼","\\thicksim");_(H,te,"≈","\\thickapprox");_(H,te,"⫆","\\supseteqq",true);_(H,te,"⋑","\\Supset",true);_(H,te,"⊐","\\sqsupset",true);_(H,te,"≽","\\succcurlyeq",true);_(H,te,"⋟","\\curlyeqsucc",true);_(H,te,"≿","\\succsim",true);_(H,te,"⪸","\\succapprox",true);_(H,te,"⊳","\\vartriangleright");_(H,te,"⊵","\\trianglerighteq");_(H,te,"⊩","\\Vdash",true);_(H,te,"∣","\\shortmid");_(H,te,"∥","\\shortparallel");_(H,te,"≬","\\between",true);_(H,te,"⋔","\\pitchfork",true);_(H,te,"∝","\\varpropto");_(H,te,"◀","\\blacktriangleleft");_(H,te,"∴","\\therefore",true);_(H,te,"∍","\\backepsilon");_(H,te,"▶","\\blacktriangleright");_(H,te,"∵","\\because",true);_(H,te,"⋘","\\llless");_(H,te,"⋙","\\gggtr");_(H,W,"⊲","\\lhd");_(H,W,"⊳","\\rhd");_(H,te,"≂","\\eqsim",true);_(H,te,"⋈","\\Join");_(H,te,"≑","\\Doteq",true);_(H,W,"∔","\\dotplus",true);_(H,W,"∖","\\smallsetminus");_(H,W,"⋒","\\Cap",true);_(H,W,"⋓","\\Cup",true);_(H,W,"⩞","\\doublebarwedge",true);_(H,W,"⊟","\\boxminus",true);_(H,W,"⊞","\\boxplus",true);_(H,W,"⋇","\\divideontimes",true);_(H,W,"⋉","\\ltimes",true);_(H,W,"⋊","\\rtimes",true);_(H,W,"⋋","\\leftthreetimes",true);_(H,W,"⋌","\\rightthreetimes",true);_(H,W,"⋏","\\curlywedge",true);_(H,W,"⋎","\\curlyvee",true);_(H,W,"⊝","\\circleddash",true);_(H,W,"⊛","\\circledast",true);_(H,W,"⋅","\\centerdot");_(H,W,"⊺","\\intercal",true);_(H,W,"⋒","\\doublecap");_(H,W,"⋓","\\doublecup");_(H,W,"⊠","\\boxtimes",true);_(H,te,"⇢","\\dashrightarrow",true);_(H,te,"⇠","\\dashleftarrow",true);_(H,te,"⇇","\\leftleftarrows",true);_(H,te,"⇆","\\leftrightarrows",true);_(H,te,"⇚","\\Lleftarrow",true);_(H,te,"↞","\\twoheadleftarrow",true);_(H,te,"↢","\\leftarrowtail",true);_(H,te,"↫","\\looparrowleft",true);_(H,te,"⇋","\\leftrightharpoons",true);_(H,te,"↶","\\curvearrowleft",true);_(H,te,"↺","\\circlearrowleft",true);_(H,te,"↰","\\Lsh",true);_(H,te,"⇈","\\upuparrows",true);_(H,te,"↿","\\upharpoonleft",true);_(H,te,"⇃","\\downharpoonleft",true);_(H,te,"⊶","\\origof",true);_(H,te,"⊷","\\imageof",true);_(H,te,"⊸","\\multimap",true);_(H,te,"↭","\\leftrightsquigarrow",true);_(H,te,"⇉","\\rightrightarrows",true);_(H,te,"⇄","\\rightleftarrows",true);_(H,te,"↠","\\twoheadrightarrow",true);_(H,te,"↣","\\rightarrowtail",true);_(H,te,"↬","\\looparrowright",true);_(H,te,"↷","\\curvearrowright",true);_(H,te,"↻","\\circlearrowright",true);_(H,te,"↱","\\Rsh",true);_(H,te,"⇊","\\downdownarrows",true);_(H,te,"↾","\\upharpoonright",true);_(H,te,"⇂","\\downharpoonright",true);_(H,te,"⇝","\\rightsquigarrow",true);_(H,te,"⇝","\\leadsto");_(H,te,"⇛","\\Rrightarrow",true);_(H,te,"↾","\\restriction");_(H,ne,"‘","`");_(H,ne,"$","\\$");_(j,ne,"$","\\$");_(j,ne,"$","\\textdollar");_(H,ne,"%","\\%");_(j,ne,"%","\\%");_(H,ne,"_","\\_");_(j,ne,"_","\\_");_(j,ne,"_","\\textunderscore");_(j,ne,"␣","\\textvisiblespace",true);_(H,ne,"∠","\\angle",true);_(H,ne,"∞","\\infty",true);_(H,ne,"′","\\prime");_(H,ne,"△","\\triangle");_(H,ne,"Α","\\Alpha",true);_(H,ne,"Β","\\Beta",true);_(H,ne,"Γ","\\Gamma",true);_(H,ne,"Δ","\\Delta",true);_(H,ne,"Ε","\\Epsilon",true);_(H,ne,"Ζ","\\Zeta",true);_(H,ne,"Η","\\Eta",true);_(H,ne,"Θ","\\Theta",true);_(H,ne,"Ι","\\Iota",true);_(H,ne,"Κ","\\Kappa",true);_(H,ne,"Λ","\\Lambda",true);_(H,ne,"Μ","\\Mu",true);_(H,ne,"Ν","\\Nu",true);_(H,ne,"Ξ","\\Xi",true);_(H,ne,"Ο","\\Omicron",true);_(H,ne,"Π","\\Pi",true);_(H,ne,"Ρ","\\Rho",true);_(H,ne,"Σ","\\Sigma",true);_(H,ne,"Τ","\\Tau",true);_(H,ne,"Υ","\\Upsilon",true);_(H,ne,"Φ","\\Phi",true);_(H,ne,"Χ","\\Chi",true);_(H,ne,"Ψ","\\Psi",true);_(H,ne,"Ω","\\Omega",true);_(H,ne,"A","Α");_(H,ne,"B","Β");_(H,ne,"E","Ε");_(H,ne,"Z","Ζ");_(H,ne,"H","Η");_(H,ne,"I","Ι");_(H,ne,"K","Κ");_(H,ne,"M","Μ");_(H,ne,"N","Ν");_(H,ne,"O","Ο");_(H,ne,"P","Ρ");_(H,ne,"T","Τ");_(H,ne,"X","Χ");_(H,ne,"¬","\\neg",true);_(H,ne,"¬","\\lnot");_(H,ne,"⊤","\\top");_(H,ne,"⊥","\\bot");_(H,ne,"∅","\\emptyset");_(H,ne,"∅","\\varnothing");_(H,J,"α","\\alpha",true);_(H,J,"β","\\beta",true);_(H,J,"γ","\\gamma",true);_(H,J,"δ","\\delta",true);_(H,J,"ϵ","\\epsilon",true);_(H,J,"ζ","\\zeta",true);_(H,J,"η","\\eta",true);_(H,J,"θ","\\theta",true);_(H,J,"ι","\\iota",true);_(H,J,"κ","\\kappa",true);_(H,J,"λ","\\lambda",true);_(H,J,"μ","\\mu",true);_(H,J,"ν","\\nu",true);_(H,J,"ξ","\\xi",true);_(H,J,"ο","\\omicron",true);_(H,J,"π","\\pi",true);_(H,J,"ρ","\\rho",true);_(H,J,"σ","\\sigma",true);_(H,J,"τ","\\tau",true);_(H,J,"υ","\\upsilon",true);_(H,J,"ϕ","\\phi",true);_(H,J,"χ","\\chi",true);_(H,J,"ψ","\\psi",true);_(H,J,"ω","\\omega",true);_(H,J,"ε","\\varepsilon",true);_(H,J,"ϑ","\\vartheta",true);_(H,J,"ϖ","\\varpi",true);_(H,J,"ϱ","\\varrho",true);_(H,J,"ς","\\varsigma",true);_(H,J,"φ","\\varphi",true);_(H,J,"Ϙ","\\Coppa",true);_(H,J,"ϙ","\\coppa",true);_(H,J,"ϙ","\\varcoppa",true);_(H,J,"Ϟ","\\Koppa",true);_(H,J,"ϟ","\\koppa",true);_(H,J,"Ϡ","\\Sampi",true);_(H,J,"ϡ","\\sampi",true);_(H,J,"Ϛ","\\Stigma",true);_(H,J,"ϛ","\\stigma",true);_(H,W,"∗","*");_(H,W,"+","+");_(H,W,"−","-");_(H,W,"⋅","\\cdot",true);_(H,W,"∘","\\circ");_(H,W,"÷","\\div",true);_(H,W,"±","\\pm",true);_(H,W,"×","\\times",true);_(H,W,"∩","\\cap",true);_(H,W,"∪","\\cup",true);_(H,W,"∖","\\setminus");_(H,W,"∧","\\land");_(H,W,"∨","\\lor");_(H,W,"∧","\\wedge",true);_(H,W,"∨","\\vee",true);_(H,ne,"√","\\surd");_(H,Q,"⟦","\\llbracket",true);_(H,Y,"⟧","\\rrbracket",true);_(H,Q,"⟨","\\langle",true);_(H,Q,"|","\\lvert");_(H,Q,"‖","\\lVert");_(H,Y,"?","?");_(H,Y,"!","!");_(H,Y,"‼","‼");_(H,Y,"⟩","\\rangle",true);_(H,Y,"|","\\rvert");_(H,Y,"‖","\\rVert");_(H,Q,"⦃","\\lBrace",true);_(H,Y,"⦄","\\rBrace",true);_(H,te,"=","=");_(H,te,":",":");_(H,te,"≈","\\approx",true);_(H,te,"≅","\\cong",true);_(H,te,"≥","\\ge");_(H,te,"≥","\\geq",true);_(H,te,"←","\\gets");_(H,te,">","\\gt",true);_(H,te,"∈","\\in",true);_(H,te,"∉","\\notin",true);_(H,te,"","\\@not");_(H,te,"⊂","\\subset",true);_(H,te,"⊃","\\supset",true);_(H,te,"⊆","\\subseteq",true);_(H,te,"⊇","\\supseteq",true);_(H,te,"⊈","\\nsubseteq",true);_(H,te,"⊈","\\nsubseteqq");_(H,te,"⊉","\\nsupseteq",true);_(H,te,"⊉","\\nsupseteqq");_(H,te,"⊨","\\models");_(H,te,"←","\\leftarrow",true);_(H,te,"≤","\\le");_(H,te,"≤","\\leq",true);_(H,te,"<","\\lt",true);_(H,te,"→","\\rightarrow",true);_(H,te,"→","\\to");_(H,te,"≱","\\ngeq",true);_(H,te,"≱","\\ngeqq");_(H,te,"≱","\\ngeqslant");_(H,te,"≰","\\nleq",true);_(H,te,"≰","\\nleqq");_(H,te,"≰","\\nleqslant");_(H,re," ","\\ ");_(H,re," ","~");_(H,re," ","\\space");_(H,re," ","\\nobreakspace");_(j,re," ","\\ ");_(j,re," "," ");_(j,re," ","~");_(j,re," ","\\space");_(j,re," ","\\nobreakspace");_(H,re,null,"\\nobreak");_(H,re,null,"\\allowbreak");_(H,ee,",",",");_(H,ee,";",";");_(H,W,"⊼","\\barwedge",true);_(H,W,"⊻","\\veebar",true);_(H,W,"⊙","\\odot",true);_(H,W,"⊕","\\oplus",true);_(H,W,"⊗","\\otimes",true);_(H,ne,"∂","\\partial",true);_(H,W,"⊘","\\oslash",true);_(H,W,"⊚","\\circledcirc",true);_(H,W,"⊡","\\boxdot",true);_(H,W,"△","\\bigtriangleup");_(H,W,"▽","\\bigtriangledown");_(H,W,"†","\\dagger");_(H,W,"⋄","\\diamond");_(H,W,"⋆","\\star");_(H,W,"◃","\\triangleleft");_(H,W,"▹","\\triangleright");_(H,Q,"{","\\{");_(j,ne,"{","\\{");_(j,ne,"{","\\textbraceleft");_(H,Y,"}","\\}");_(j,ne,"}","\\}");_(j,ne,"}","\\textbraceright");_(H,Q,"{","\\lbrace");_(H,Y,"}","\\rbrace");_(H,Q,"[","\\lbrack",true);_(j,ne,"[","\\lbrack",true);_(H,Y,"]","\\rbrack",true);_(j,ne,"]","\\rbrack",true);_(H,Q,"(","\\lparen",true);_(H,Y,")","\\rparen",true);_(j,ne,"<","\\textless",true);_(j,ne,">","\\textgreater",true);_(H,Q,"⌊","\\lfloor",true);_(H,Y,"⌋","\\rfloor",true);_(H,Q,"⌈","\\lceil",true);_(H,Y,"⌉","\\rceil",true);_(H,ne,"\\","\\backslash");_(H,ne,"|","|");_(H,ne,"|","\\vert");_(j,ne,"|","\\textbar",true);_(H,ne,"‖","\\|");_(H,ne,"‖","\\Vert");_(j,ne,"‖","\\textbardbl");_(j,ne,"~","\\textasciitilde");_(j,ne,"\\","\\textbackslash");_(j,ne,"^","\\textasciicircum");_(H,te,"↑","\\uparrow",true);_(H,te,"⇑","\\Uparrow",true);_(H,te,"↓","\\downarrow",true);_(H,te,"⇓","\\Downarrow",true);_(H,te,"↕","\\updownarrow",true);_(H,te,"⇕","\\Updownarrow",true);_(H,K,"∐","\\coprod");_(H,K,"⋁","\\bigvee");_(H,K,"⋀","\\bigwedge");_(H,K,"⨄","\\biguplus");_(H,K,"⋂","\\bigcap");_(H,K,"⋃","\\bigcup");_(H,K,"∫","\\int");_(H,K,"∫","\\intop");_(H,K,"∬","\\iint");_(H,K,"∭","\\iiint");_(H,K,"∏","\\prod");_(H,K,"∑","\\sum");_(H,K,"⨂","\\bigotimes");_(H,K,"⨁","\\bigoplus");_(H,K,"⨀","\\bigodot");_(H,K,"∮","\\oint");_(H,K,"∯","\\oiint");_(H,K,"∰","\\oiiint");_(H,K,"∱","\\intclockwise");_(H,K,"∲","\\varointclockwise");_(H,K,"⨌","\\iiiint");_(H,K,"⨍","\\intbar");_(H,K,"⨎","\\intBar");_(H,K,"⨏","\\fint");_(H,K,"⨒","\\rppolint");_(H,K,"⨓","\\scpolint");_(H,K,"⨕","\\pointint");_(H,K,"⨖","\\sqint");_(H,K,"⨗","\\intlarhk");_(H,K,"⨘","\\intx");_(H,K,"⨙","\\intcap");_(H,K,"⨚","\\intcup");_(H,K,"⨅","\\bigsqcap");_(H,K,"⨆","\\bigsqcup");_(H,K,"∫","\\smallint");_(j,Z,"…","\\textellipsis");_(H,Z,"…","\\mathellipsis");_(j,Z,"…","\\ldots",true);_(H,Z,"…","\\ldots",true);_(H,Z,"⋰","\\iddots",true);_(H,Z,"⋯","\\@cdots",true);_(H,Z,"⋱","\\ddots",true);_(H,ne,"⋮","\\varvdots");_(H,X,"ˊ","\\acute");_(H,X,"ˋ","\\grave");_(H,X,"¨","\\ddot");_(H,X,"⃛","\\dddot");_(H,X,"⃜","\\ddddot");_(H,X,"~","\\tilde");_(H,X,"ˉ","\\bar");_(H,X,"˘","\\breve");_(H,X,"ˇ","\\check");_(H,X,"^","\\hat");_(H,X,"⃗","\\vec");_(H,X,"˙","\\dot");_(H,X,"˚","\\mathring");_(H,J,"ı","\\imath",true);_(H,J,"ȷ","\\jmath",true);_(H,ne,"ı","ı");_(H,ne,"ȷ","ȷ");_(j,ne,"ı","\\i",true);_(j,ne,"ȷ","\\j",true);_(j,ne,"ß","\\ss",true);_(j,ne,"æ","\\ae",true);_(j,ne,"œ","\\oe",true);_(j,ne,"ø","\\o",true);_(j,ne,"Æ","\\AE",true);_(j,ne,"Œ","\\OE",true);_(j,ne,"Ø","\\O",true);_(j,X,"ˊ","\\'");_(j,X,"ˋ","\\`");_(j,X,"ˆ","\\^");_(j,X,"˜","\\~");_(j,X,"ˉ","\\=");_(j,X,"˘","\\u");_(j,X,"˙","\\.");_(j,X,"˚","\\r");_(j,X,"ˇ","\\v");_(j,X,"¨",'\\"');_(j,X,"˝","\\H");const se={"--":true,"---":true,"``":true,"''":true};_(j,ne,"–","--",true);_(j,ne,"–","\\textendash");_(j,ne,"—","---",true);_(j,ne,"—","\\textemdash");_(j,ne,"‘","`",true);_(j,ne,"‘","\\textquoteleft");_(j,ne,"’","'",true);_(j,ne,"’","\\textquoteright");_(j,ne,"“","``",true);_(j,ne,"“","\\textquotedblleft");_(j,ne,"”","''",true);_(j,ne,"”","\\textquotedblright");_(H,ne,"°","\\degree",true);_(j,ne,"°","\\degree");_(j,ne,"°","\\textdegree",true);_(H,ne,"£","\\pounds");_(H,ne,"£","\\mathsterling",true);_(j,ne,"£","\\pounds");_(j,ne,"£","\\textsterling",true);_(H,ne,"✠","\\maltese");_(j,ne,"✠","\\maltese");_(H,ne,"€","\\euro");_(j,ne,"€","\\euro");_(j,ne,"€","\\texteuro");_(H,ne,"©","\\copyright",true);_(j,ne,"©","\\textcopyright");_(H,ne,"®","\\copyright",true);_(H,ne,"𝛤","\\varGamma");_(H,ne,"𝛥","\\varDelta");_(H,ne,"𝛩","\\varTheta");_(H,ne,"𝛬","\\varLambda");_(H,ne,"𝛯","\\varXi");_(H,ne,"𝛱","\\varPi");_(H,ne,"𝛴","\\varSigma");_(H,ne,"𝛶","\\varUpsilon");_(H,ne,"𝛷","\\varPhi");_(H,ne,"𝛹","\\varPsi");_(H,ne,"𝛺","\\varOmega");_(j,ne,"𝛤","\\varGamma");_(j,ne,"𝛥","\\varDelta");_(j,ne,"𝛩","\\varTheta");_(j,ne,"𝛬","\\varLambda");_(j,ne,"𝛯","\\varXi");_(j,ne,"𝛱","\\varPi");_(j,ne,"𝛴","\\varSigma");_(j,ne,"𝛶","\\varUpsilon");_(j,ne,"𝛷","\\varPhi");_(j,ne,"𝛹","\\varPsi");_(j,ne,"𝛺","\\varOmega");const oe='0123456789/@."';for(let e=0;e<oe.length;e++){const t=oe.charAt(e);_(H,ne,t,t)}const ae='0123456789!@*()-=+";:?/.,';for(let e=0;e<ae.length;e++){const t=ae.charAt(e);_(j,ne,t,t)}const ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let e=0;e<ie.length;e++){const t=ie.charAt(e);_(H,J,t,t);_(j,ne,t,t)}const le="ÇÐÞçþℂℍℕℙℚℝℤℎℏℊℋℌℐℑℒℓ℘ℛℜℬℰℱℳℭℨ";for(let e=0;e<le.length;e++){const t=le.charAt(e);_(H,J,t,t);_(j,ne,t,t)}let ue="";for(let e=0;e<ie.length;e++){ue=String.fromCharCode(55349,56320+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56372+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56424+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56580+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56736+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56788+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56840+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56944+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,56632+e);_(H,J,ue,ue);_(j,ne,ue,ue);const t=ie.charAt(e);ue=String.fromCharCode(55349,56476+e);_(H,J,t,ue);_(j,ne,t,ue)}for(let e=0;e<10;e++){ue=String.fromCharCode(55349,57294+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,57314+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,57324+e);_(H,J,ue,ue);_(j,ne,ue,ue);ue=String.fromCharCode(55349,57334+e);_(H,J,ue,ue);_(j,ne,ue,ue)}function ce(e,t){const r=[];let n=[];let s=[];let o=false;for(let t=0;t<e.length;t++){const a=e[t];if(a.attributes&&a.attributes.linebreak&&a.attributes.linebreak==="newline"){if(s.length>0){n.push(new E.MathNode("mrow",s))}n.push(a);s=[];const e=new E.MathNode("mtd",n);r.push(new E.MathNode("mtr",[e]));n=[];continue}s.push(a);if(a.type&&a.type==="mo"){if(o&&!a.attributes.form){const r=t<e.length-1?e[t+1]:null;let a=true;if(!(r&&r.type==="mtext"&&r.attributes.linebreak&&r.attributes.linebreak==="nobreak")){for(let r=t+1;r<e.length;r++){const n=e[r];if(n.type&&n.type==="mspace"&&!(n.attributes.linebreak&&n.attributes.linebreak==="newline")){s.push(n);t+=1;if(n.attributes&&n.attributes.linebreak&&n.attributes.linebreak==="nobreak"){a=false}}else{break}}}if(a){n.push(new E.MathNode("mrow",s));s=[]}o=false}const r=a.attributes.form&&a.attributes.form==="prefix";o=!(a.attributes.separator||r)}else{o=true}}if(s.length>0){n.push(new E.MathNode("mrow",s))}if(r.length>0){const e=new E.MathNode("mtd",n);const s=new E.MathNode("mtr",[e]);r.push(s);const o=new E.MathNode("mtable",r);if(!t){o.setAttribute("columnalign","left");o.setAttribute("rowspacing","0em")}return o}return E.newDocumentFragment(n)}const me=function(e,t,r){if(V[t][e]&&V[t][e].replace&&e.charCodeAt(0)!==55349&&!(Object.prototype.hasOwnProperty.call(se,e)&&r&&(r.fontFamily&&r.fontFamily.substr(4,2)==="tt"||r.font&&r.font.substr(4,2)==="tt"))){e=V[t][e].replace}return new E.TextNode(e)};const pe=function(e){if(e.length===1){return e[0]}else{return new E.MathNode("mrow",e)}};const de=function(e,t,r){if(e.length===1){const n=ge(e[0],t);if(r&&n instanceof O&&n.type==="mo"){n.setAttribute("lspace","0em");n.setAttribute("rspace","0em")}return[n]}const n=[];for(let r=0;r<e.length;r++){const s=ge(e[r],t);n.push(s)}return n};const he=function(e,t,r){return pe(de(e,t,r))};const ge=function(t,r){if(!t){return new E.MathNode("mrow")}if(f[t.type]){const e=f[t.type](t,r);return e}else{throw new e("Got group of unknown type: '"+t.type+"'")}};const fe=(e,t,r,n)=>{const s=new E.MathNode("mtd",[]);s.setAttribute("style","padding: 0;width: 50%;");t=he(t[0].body,r);t.classes=["tml-tag"];t=new E.MathNode("mpadded",[t]);t.setAttribute("style","width:0;");t.setAttribute("width","0");t.setAttribute(n?"rspace":"lspace","-1width");t=new E.MathNode("mtd",[t]);t.setAttribute("style","padding: 0; min-width:0");e=new E.MathNode("mtd",[e]);const o=n?[t,s,e,s]:[s,e,s,t];const a=new E.MathNode("mtr",o,["tml-tageqn"]);const i=new E.MathNode("mtable",[a]);i.setAttribute("width","100%");return i};function be(e,t,r,n){let s=null;if(e.length===1&&e[0].type==="tag"){s=e[0].tag;e=e[0].body}const o=de(e,r);let a=o.length===1&&s!==null&&o[0]instanceof O&&d.contains(["mrow","mtable"],o[0].type)?o[0]:ce(o,n.displayMode);if(s){a=fe(a,s,r,n.leqno)}else if(a.children.length===1&&n.displayMode){a.children[0].setAttribute("display","block");a.children[0].setAttribute("style","width: 100%;")}const i=new E.MathNode("math",[a],["temml"]);i.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML");i.setAttribute("data-tex",t);if(n.displayMode){i.setAttribute("display","block")}return i}const ye=(e,t)=>{const r=e.isStretchy?P.mathMLnode(e.label):new E.MathNode("mo",[me(e.label,e.mode)]);const n=new E.MathNode("mover",[ge(e.base,t),r]);n.setAttribute("accent","true");return n};const we=new RegExp(["\\acute","\\grave","\\ddot","\\dddot","\\ddddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map((e=>`\\${e}`)).join("|"));b({type:"accent",names:["\\acute","\\grave","\\ddot","\\dddot","\\ddddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\overparen","\\widecheck","\\widehat","\\wideparen","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overleftharpoon","\\overrightharpoon","\\overlinesegment"],props:{numArgs:1},handler:(e,t)=>{const r=w(t[0]);const n=!we.test(e.funcName);const s=!n||e.funcName==="\\widehat"||e.funcName==="\\widetilde"||e.funcName==="\\widecheck";return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:n,isShifty:s,base:r}},mathmlBuilder:ye});b({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\r","\\H","\\v"],props:{numArgs:1,allowedInText:true,allowedInMath:false,argTypes:["primitive"]},handler:(e,t)=>{const r=t[0];return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:false,isShifty:true,base:r}},mathmlBuilder:ye});b({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underparen","\\utilde","\\underlinesegment"],props:{numArgs:1},handler:({parser:e,funcName:t},r)=>{const n=r[0];return{type:"accentUnder",mode:e.mode,label:t,base:n}},mathmlBuilder:(e,t)=>{const r=P.mathMLnode(e.label);const n=new E.MathNode("munder",[ge(e.base,t),r]);n.setAttribute("accentunder","true");return n}});const xe=e=>{const t=new E.MathNode("mpadded",e?[e]:[]);t.setAttribute("width","+0.6em");t.setAttribute("lspace","0.3em");return t};b({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\longrightleftharpoons","\\longleftrightarrows","\\longRightleftharpoons","\\longLeftrightharpoons","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler({parser:e,funcName:t},r,n){return{type:"xArrow",mode:e.mode,label:t,body:r[0],below:n[0],macros:e.gullet.macros}},mathmlBuilder(e,t){const r=P.mathMLnode(e.label,e.macros);const n=e.label.charAt(0)==="x"?"1.75em":"3.0em";r.setAttribute("minsize",n);let s;const o=t.incrementStyle();if(e.body){const t=xe(ge(e.body,o));if(e.below){const n=xe(ge(e.below,o));s=new E.MathNode("munderover",[r,n,t])}else{s=new E.MathNode("mover",[r,t])}}else if(e.below){const t=xe(ge(e.below,o));s=new E.MathNode("munder",[r,t])}else{s=xe();s=new E.MathNode("mover",[r,s])}return s}});b({type:"cancelto",names:["\\cancelto"],props:{numArgs:2},handler({parser:e},t){return{type:"cancelto",mode:e.mode,value:t[0],expression:t[1]}},mathmlBuilder(e,t){const r=new E.MathNode("mpadded",[ge(e.value,t)]);r.setAttribute("depth",`-0.1em`);r.setAttribute("height",`+0.1em`);r.setAttribute("voffset",`0.1em`);const n=new E.MathNode("menclose",[ge(e.expression,t)]);n.setAttribute("notation",`updiagonalarrow`);return new E.MathNode("msup",[n,r])}});function ke(e,t){if(!e||e.type!==t){throw new Error(`Expected node of type ${t}, but got `+(e?`node of type ${e.type}`:String(e)))}return e}function Ae(e){const t=ve(e);if(!t){throw new Error(`Expected node of symbol group type, but got `+(e?`node of type ${e.type}`:String(e)))}return t}function ve(e){if(e&&(e.type==="atom"||R.hasOwnProperty(e.type))){return e}return null}const Te={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"};const Ne=()=>({type:"styling",body:[],mode:"math",style:"display"});const Se=e=>e.type==="textord"&&e.text==="@";const qe=(e,t)=>(e.type==="mathord"||e.type==="atom")&&e.text===t;function Me(e,t,r){const n=Te[e];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return r.callFunction(n,[t[0]],[t[1]]);case"\\uparrow":case"\\downarrow":{const e=r.callFunction("\\\\cdleft",[t[0]],[]);const s={type:"atom",text:n,mode:"math",family:"rel"};const o=r.callFunction("\\Big",[s],[]);const a=r.callFunction("\\\\cdright",[t[1]],[]);const i={type:"ordgroup",mode:"math",body:[e,o,a]};return r.callFunction("\\\\cdparent",[i],[])}case"\\\\cdlongequal":return r.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{const e={type:"textord",text:"\\Vert",mode:"math"};return r.callFunction("\\Big",[e],[])}default:return{type:"textord",text:" ",mode:"math"}}}function Be(t){const r=[];t.gullet.beginGroup();t.gullet.macros.set("\\cr","\\\\\\relax");t.gullet.beginGroup();while(true){r.push(t.parseExpression(false,"\\\\"));t.gullet.endGroup();t.gullet.beginGroup();const n=t.fetch().text;if(n==="&"||n==="\\\\"){t.consume()}else if(n==="\\end"){if(r[r.length-1].length===0){r.pop()}break}else{throw new e("Expected \\\\ or \\cr or \\end",t.nextToken)}}let n=[];const s=[n];for(let o=0;o<r.length;o++){const a=r[o];let i=Ne();for(let r=0;r<a.length;r++){if(!Se(a[r])){i.body.push(a[r])}else{n.push(i);r+=1;const s=Ae(a[r]).text;const o=new Array(2);o[0]={type:"ordgroup",mode:"math",body:[]};o[1]={type:"ordgroup",mode:"math",body:[]};if("=|.".indexOf(s)>-1);else if("<>AV".indexOf(s)>-1){for(let t=0;t<2;t++){let n=true;for(let i=r+1;i<a.length;i++){if(qe(a[i],s)){n=false;r=i;break}if(Se(a[i])){throw new e("Missing a "+s+" character to complete a CD arrow.",a[i])}o[t].body.push(a[i])}if(n){throw new e("Missing a "+s+" character to complete a CD arrow.",a[r])}}}else{throw new e(`Expected one of "<>AV=|." after @.`)}const l=Me(s,o,t);n.push(l);i=Ne()}}if(o%2===0){n.push(i)}else{n.shift()}n=[];s.push(n)}t.gullet.endGroup();t.gullet.endGroup();const o=new Array(s[0].length).fill({type:"align",align:"c"});return{type:"array",mode:"math",body:s,arraystretch:1,addJot:true,rowGaps:[null],cols:o,colSeparationType:"CD",hLinesBeforeRow:new Array(s.length+1).fill([])}}b({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler({parser:e,funcName:t},r){return{type:"cdlabel",mode:e.mode,side:t.slice(4),label:r[0]}},mathmlBuilder(e,t){let r=new E.MathNode("mrow",[ge(e.label,t)]);r=new E.MathNode("mpadded",[r]);r.setAttribute("width","0");if(e.side==="left"){r.setAttribute("lspace","-1width")}r.setAttribute("voffset","0.7em");r=new E.MathNode("mstyle",[r]);r.setAttribute("displaystyle","false");r.setAttribute("scriptlevel","1");return r}});b({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler({parser:e},t){return{type:"cdlabelparent",mode:e.mode,fragment:t[0]}},mathmlBuilder(e,t){return new E.MathNode("mrow",[ge(e.fragment,t)])}});b({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:true},handler({parser:t},r){const n=ke(r[0],"ordgroup");const s=n.body;let o="";for(let e=0;e<s.length;e++){const t=ke(s[e],"textord");o+=t.text}const a=parseInt(o);if(isNaN(a)){throw new e(`\\@char has non-numeric argument ${o}`)}return{type:"textord",mode:t.mode,text:String.fromCharCode(a)}}});const Oe=(e,t)=>{const r=de(e.body,t.withColor(e.color));const n=new E.MathNode("mstyle",r);n.setAttribute("mathcolor",e.color);return n};b({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:true,argTypes:["color","original"]},handler({parser:e},t){const r=ke(t[0],"color-token").color;const n=t[1];return{type:"color",mode:e.mode,color:r,body:x(n)}},mathmlBuilder:Oe});b({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:true,argTypes:["color"]},handler({parser:e,breakOnTokenText:t},r){const n=ke(r[0],"color-token").color;e.gullet.macros.set("\\current@color",n);const s=e.parseExpression(true,t);return{type:"color",mode:e.mode,color:n,body:s}},mathmlBuilder:Oe});const Ce={pt:800/803,pc:12*800/803,dd:1238/1157*800/803,cc:14856/1157*800/803,nd:685/642*800/803,nc:1370/107*800/803,sp:1/65536*800/803};const Ee=["em","ex","mu","pt","mm","cm","in","px","bp","pc","dd","cc","nd","nc","sp"];const Ie=function(e){if(typeof e!=="string"){e=e.unit}return Ee.indexOf(e)>-1};const $e=e=>{const t=Math.max(e-1,0);return[1,.7,.5][t]};const ze=function(t,r){const n=t.number;const s=t.unit;switch(s){case"mm":case"cm":case"in":case"px":return{number:n,unit:s};case"em":case"ex":return{number:d.round(n/$e(r.style)),unit:s};case"bp":return{number:n,unit:"pt"};case"pt":case"pc":case"dd":case"cc":case"nd":case"nc":case"sp":return{number:d.round(n*Ce[s]),unit:"pt"};case"mu":{return{number:d.round(n/18),unit:"em"}}default:throw new e("Invalid unit: '"+s+"'")}};b({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:1,argTypes:["size"],allowedInText:true},handler({parser:e},t,r){const n=r[0];if(e.settings.displayMode&&e.settings.strict==="warn"){e.settings.reportNonstrict("newLineInDisplayMode","In LaTeX, \\\\ or \\newline "+"does nothing in display mode")}const s=!e.settings.displayMode||e.settings.strict!==true;return{type:"cr",mode:e.mode,newLine:s,size:n&&ke(n,"size").value}},mathmlBuilder(e,t){const r=new E.MathNode("mo");if(e.newLine){r.setAttribute("linebreak","newline");if(e.size){const n=ze(e.size,t);r.setAttribute("height",n.number+n.unit)}}return r}});const De={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"};const Le=t=>{const r=t.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(r)){throw new e("Expected a control sequence",t)}return r};const Fe=e=>{let t=e.gullet.popToken();if(t.text==="="){t=e.gullet.popToken();if(t.text===" "){t=e.gullet.popToken()}}return t};const Ge=(e,t,r,n)=>{let s=e.gullet.macros.get(r.text);if(s==null){r.noexpand=true;s={tokens:[r],numArgs:0,unexpandable:!e.gullet.isExpandable(r.text)}}e.gullet.macros.set(t,s,n)};b({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:true},handler({parser:t,funcName:r}){t.consumeSpaces();const n=t.fetch();if(De[n.text]){if(r==="\\global"||r==="\\\\globallong"){n.text=De[n.text]}return ke(t.parseFunction(),"internal")}throw new e(`Invalid token after macro prefix`,n)}});b({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:true,primitive:true},handler({parser:t,funcName:r}){let n=t.gullet.popToken();const s=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(s)){throw new e("Expected a control sequence",n)}let o=0;let a;const i=[[]];while(t.gullet.future().text!=="{"){n=t.gullet.popToken();if(n.text==="#"){if(t.gullet.future().text==="{"){a=t.gullet.future();i[o].push("{");break}n=t.gullet.popToken();if(!/^[1-9]$/.test(n.text)){throw new e(`Invalid argument number "${n.text}"`)}if(parseInt(n.text)!==o+1){throw new e(`Argument number "${n.text}" out of order`)}o++;i.push([])}else if(n.text==="EOF"){throw new e("Expected a macro definition")}else{i[o].push(n.text)}}let{tokens:l}=t.gullet.consumeArg();if(a){l.unshift(a)}if(r==="\\edef"||r==="\\xdef"){l=t.gullet.expandTokens(l);l.reverse()}t.gullet.macros.set(s,{tokens:l,numArgs:o,delimiters:i},r===De[r]);return{type:"internal",mode:t.mode}}});b({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:true,primitive:true},handler({parser:e,funcName:t}){const r=Le(e.gullet.popToken());e.gullet.consumeSpaces();const n=Fe(e);Ge(e,r,n,t==="\\\\globallet");return{type:"internal",mode:e.mode}}});b({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:true,primitive:true},handler({parser:e,funcName:t}){const r=Le(e.gullet.popToken());const n=e.gullet.popToken();const s=e.gullet.popToken();Ge(e,r,s,t==="\\\\globalfuture");e.gullet.pushToken(s);e.gullet.pushToken(n);return{type:"internal",mode:e.mode}}});b({type:"internal",names:["\\newcommand","\\renewcommand","\\providecommand"],props:{numArgs:0,allowedInText:true,primitive:true},handler({parser:t,funcName:r}){let n="";const s=t.gullet.popToken();if(s.text==="{"){n=Le(t.gullet.popToken());t.gullet.popToken()}else{n=Le(s)}const o=t.gullet.isDefined(n);if(o&&r==="\\newcommand"){throw new e(`\\newcommand{${n}} attempting to redefine ${n}; use \\renewcommand`)}if(!o&&r==="\\renewcommand"){throw new e(`\\renewcommand{${n}} when command ${n} does not yet exist; use \\newcommand`)}let a=0;if(t.gullet.future().text==="["){let r=t.gullet.popToken();r=t.gullet.popToken();if(!/^[1-9]$/.test(r.text)){throw new e(`Invalid number of arguments: "${r.text}"`)}a=parseInt(r.text);r=t.gullet.popToken();if(r.text!=="]"){throw new e(`Invalid argument "${r.text}"`)}}const{tokens:i}=t.gullet.consumeArg();t.gullet.macros.set(n,{tokens:i,numArgs:a},!t.settings.strict);return{type:"internal",mode:t.mode}}});const Pe={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}};const Ue=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","\\llbracket","\\rrbracket","⟦","⟦","\\lBrace","\\rBrace","⦃","⦄","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];const Re=[0,1.2,1.8,2.4,3];function Ve(t,r){const n=ve(t);if(n&&d.contains(Ue,n.text)){if(d.contains(["<","\\lt"],n.text)){n.text="⟨"}if(d.contains([">","\\gt"],n.text)){n.text="⟩"}return n}else if(n){throw new e(`Invalid delimiter '${n.text}' after '${r.funcName}'`,t)}else{throw new e(`Invalid delimiter type '${t.type}'`,t)}}b({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{const r=Ve(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:Pe[e.funcName].size,mclass:Pe[e.funcName].mclass,delim:r.text}},mathmlBuilder:e=>{const t=[];if(e.delim!=="."){t.push(me(e.delim,e.mode))}const r=new E.MathNode("mo",t);if(e.mclass==="mopen"||e.mclass==="mclose"){r.setAttribute("fence","true")}else{r.setAttribute("fence","false")}r.setAttribute("stretchy","true");r.setAttribute("symmetric","true");r.setAttribute("minsize",Re[e.size]+"em");r.setAttribute("maxsize",Re[e.size]+"em");return r}});function _e(e){if(!e.body){throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}}b({type:"leftright-right",names:["\\right"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,r)=>{const n=t.parser.gullet.macros.get("\\current@color");if(n&&typeof n!=="string"){throw new e("\\current@color set to non-string in \\right")}return{type:"leftright-right",mode:t.parser.mode,delim:Ve(r[0],t).text,color:n}}});b({type:"leftright",names:["\\left"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{const r=Ve(t[0],e);const n=e.parser;++n.leftrightDepth;const s=n.parseExpression(false);--n.leftrightDepth;n.expect("\\right",false);const o=ke(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:s,left:r.text,right:o.delim,rightColor:o.color}},mathmlBuilder:(e,t)=>{_e(e);const r=de(e.body,t);if(e.left!=="."){const t=new E.MathNode("mo",[me(e.left,e.mode)]);t.setAttribute("fence","true");t.setAttribute("form","prefix");r.unshift(t)}if(e.right!=="."){const t=new E.MathNode("mo",[me(e.right,e.mode)]);t.setAttribute("fence","true");t.setAttribute("form","postfix");if(e.rightColor){t.setAttribute("mathcolor",e.rightColor)}r.push(t)}return pe(r)}});b({type:"middle",names:["\\middle"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,r)=>{const n=Ve(r[0],t);if(!t.parser.leftrightDepth){throw new e("\\middle without preceding \\left",n)}return{type:"middle",mode:t.parser.mode,delim:n.text}},mathmlBuilder:(e,t)=>{const r=me(e.delim,e.mode);const n=new E.MathNode("mo",[r]);n.setAttribute("fence","true");n.setAttribute("lspace","0.05em");n.setAttribute("rspace","0.05em");return n}});const He=(e,t)=>{const r=new E.MathNode(e.label.indexOf("colorbox")>-1?"mpadded":"menclose",[ge(e.body,t)]);switch(e.label){case"\\cancel":r.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":r.setAttribute("notation","downdiagonalstrike");break;case"\\longdiv":r.setAttribute("notation","longdiv");break;case"\\phase":r.setAttribute("notation","phasorangle");break;case"\\sout":r.setAttribute("notation","horizontalstrike");break;case"\\fbox":r.setAttribute("notation","box");break;case"\\angl":r.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":let t=3;r.setAttribute("width",`+${2*t}pt`);r.setAttribute("height",`+${2*t}pt`);r.setAttribute("lspace",`${t}pt`);r.setAttribute("voffset",`${t}pt`);if(e.label==="\\fcolorbox"){r.setAttribute("style","border: 0.06em solid "+String(e.borderColor))}break;case"\\xcancel":r.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}if(e.backgroundColor){r.setAttribute("mathbackground",e.backgroundColor)}return r};b({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:true,argTypes:["color","text"]},handler({parser:e,funcName:t},r,n){const s=ke(r[0],"color-token").color;const o=r[1];return{type:"enclose",mode:e.mode,label:t,backgroundColor:s,body:o}},mathmlBuilder:He});b({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:true,argTypes:["color","color","text"]},handler({parser:e,funcName:t},r,n){const s=ke(r[0],"color-token").color;const o=ke(r[1],"color-token").color;const a=r[2];return{type:"enclose",mode:e.mode,label:t,backgroundColor:o,borderColor:s,body:a}},mathmlBuilder:He});b({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:true},handler({parser:e},t){return{type:"enclose",mode:e.mode,label:"\\fbox",body:t[0]}}});b({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase","\\longdiv"],props:{numArgs:1},handler({parser:e,funcName:t},r){const n=r[0];return{type:"enclose",mode:e.mode,label:t,body:n}},mathmlBuilder:He});b({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:false},handler({parser:e},t){return{type:"enclose",mode:e.mode,label:"\\angl",body:t[0]}}});const je={};function Xe({type:e,names:t,props:r,handler:n,mathmlBuilder:s}){const o={type:e,numArgs:r.numArgs||0,allowedInText:false,numOptionalArgs:0,handler:n};for(let e=0;e<t.length;++e){je[t[e]]=o}if(s){f[e]=s}}const We={DISPLAY:0,TEXT:1,SCRIPT:2,SCRIPTSCRIPT:3};function Ye(e){const t=[];e.consumeSpaces();let r=e.fetch().text;while(r==="\\hline"||r==="\\hdashline"){e.consume();t.push(r==="\\hdashline");e.consumeSpaces();r=e.fetch().text}return t}const Ze=t=>{const r=t.parser.settings;if(!r.displayMode){throw new e(`{${t.envName}} can be used only in`+` display mode.`)}};const Je=(e,t,r)=>{let n;const s=e.tags.shift();if(s){if(s.body){n=he(s.body,t);n.classes=["tml-tag"]}else{n=new E.MathNode("mtd",[]);n.setAttribute("style","padding: 0; min-width:0");return n}}else if(e.colSeparationType==="multline"&&(e.leqno&&r!==0||!e.leqno&&r!==e.body.length-1)){n=new E.MathNode("mtd",[]);n.setAttribute("style","padding: 0; min-width:0");return n}else{n=new E.MathNode("mtext",[],["tml-eqn"])}n=new E.MathNode("mpadded",[n]);n.setAttribute("style","width:0;");n.setAttribute("width","0");if(!e.leqno){n.setAttribute("lspace","-1width")}n=new E.MathNode("mtd",[n]);n.setAttribute("style","padding: 0; min-width:0");return n};function Ke(t,{hskipBeforeAndAfter:r,addJot:n,cols:s,arraystretch:o,colSeparationType:a,addEqnNum:i,singleRow:l,maxNumCols:u,leqno:c},m){t.gullet.beginGroup();if(!l){t.gullet.macros.set("\\cr","\\\\\\relax")}if(i){t.gullet.macros.set("\\tag","\\env@tag{\\text{#1}}");t.gullet.macros.set("\\notag","\\env@notag")}if(!o){const r=t.gullet.expandMacroAsText("\\arraystretch");if(r==null){o=1}else{o=parseFloat(r);if(!o||o<0){throw new e(`Invalid \\arraystretch: ${r}`)}}}t.gullet.beginGroup();let p=[];const d=[p];const h=[];const g=[];let f;const b=[];b.push(Ye(t));while(true){let r=t.parseExpression(false,l?"\\end":"\\\\");if(i&&!f){for(let e=0;e<r.length;e++){if(r[e].type==="envTag"||r[e].type==="noTag"){f=r[e].type==="envTag"?r.splice(e,1)[0].body.body[0]:{body:null};break}}}t.gullet.endGroup();t.gullet.beginGroup();r={type:"ordgroup",mode:t.mode,body:r};p.push(r);const n=t.fetch().text;if(n==="&"){if(u&&p.length===u){if(l||a){throw new e("Too many tab characters: &",t.nextToken)}else{t.settings.reportNonstrict("textEnv","Too few columns "+"specified in the {array} column argument.")}}t.consume()}else if(n==="\\end"){if(p.length===1&&r.body.length===0){d.pop()}if(b.length<d.length+1){b.push([])}break}else if(n==="\\\\"){t.consume();let e;if(t.gullet.future().text!==" "){e=t.parseSizeGroup(true)}h.push(e?e.value:null);g.push(f);b.push(Ye(t));p=[];f=null;d.push(p)}else{throw new e("Expected & or \\\\ or \\cr or \\end",t.nextToken)}}t.gullet.endGroup();t.gullet.endGroup();g.push(f);return{type:"array",mode:t.mode,addJot:n,arraystretch:o,body:d,cols:s,rowGaps:h,hskipBeforeAndAfter:r,hLinesBeforeRow:b,colSeparationType:a,addEqnNum:i,style:m,tags:g,leqno:c}}function Qe(e){return e.substr(0,1)==="d"?"display":"text"}const et={c:"center ",l:"left ",r:"right "};const tt=function(e,t){const r=[];const n=e.body.length;let s;if(e.addEqnNum){s=new E.MathNode("mtd",[],[]);const t="padding: 0;width: "+(e.colSeparationType==="multline"?"7.5%":"50%");s.setAttribute("style",t)}for(let o=0;o<n;o++){const a=e.body[o];const i=[];const l=e.style==="text"?We.TEXT:We.DISPLAY;for(let r=0;r<a.length;r++){const s=new E.MathNode("mtd",[ge(a[r],t.withStyle(l))]);if(e.colSeparationType==="multline"){const e=o===0?"left":o===n-1?"right":"center";s.setAttribute("columnalign",e)}i.push(s)}if(e.addEqnNum){i.unshift(s);i.push(s);const r=Je(e,t.withStyle(l),o);if(e.leqno){i.unshift(r)}else{i.push(r)}}r.push(new E.MathNode("mtr",i,e.addEqnNum?["tml-tageqn"]:[]))}let o=new E.MathNode("mtable",r);if(e.style==="display"){o.setAttribute("displaystyle","true")}const a=e.arraystretch===.5?.1:.16+e.arraystretch-1+(e.addJot?.09:0);o.setAttribute("rowspacing",d.round(a)+"em");if(e.addEqnNum||e.colSeparationType==="multline"){o.setAttribute("width","100%")}let i="";let l="";if(e.cols&&e.cols.length>0){const t=e.cols;let r="";let n=false;let s=0;let a=t.length;if(t[0].type==="separator"){i+="top ";s=1}if(t[t.length-1].type==="separator"){i+="bottom ";a-=1}for(let e=s;e<a;e++){if(t[e].type==="align"){l+=et[t[e].align];if(n){r+="none "}n=true}else if(t[e].type==="separator"){if(n){r+=t[e].separator==="|"?"solid ":"dashed ";n=false}}}if(e.addEqnNum){l="left "+l+"right ";l=e.leqno?"left "+l:l+="right"}o.setAttribute("columnalign",l.trim());if(/[sd]/.test(r)){o.setAttribute("columnlines",r.trim())}}switch(e.colSeparationType){case"gather":case"gathered":case"alignedat":case"alignat":case"alignat*":o.setAttribute("columnspacing","0em");break;case"small":o.setAttribute("columnspacing","0.2778em");break;case"CD":o.setAttribute("columnspacing","0.5em");break;case"align":case"align*":{const t=e.cols||[];let r=e.addEqnNum?"0em ":"";for(let e=1;e<t.length;e++){r+=e%2?"0em ":"1em "}if(e.addEqnNum){r+="0em"}o.setAttribute("columnspacing",r.trim());break}default:o.setAttribute("columnspacing","1em")}let u="";const c=e.hLinesBeforeRow;i+=c[0].length>0?"left ":"";i+=c[c.length-1].length>0?"right ":"";for(let e=1;e<c.length-1;e++){u+=c[e].length===0?"none ":c[e][0]?"dashed ":"solid "}if(/[sd]/.test(u)){o.setAttribute("rowlines",u.trim())}if(i!==""){o=new E.MathNode("menclose",[o]);o.setAttribute("notation",i.trim())}if(e.arraystretch&&e.arraystretch<1){o=new E.MathNode("mstyle",[o]);o.setAttribute("scriptlevel","1")}return o};const rt=function(t,r){if(t.envName.indexOf("ed")===-1){Ze(t)}const n=[];const s=Ke(t.parser,{cols:n,addJot:true,addEqnNum:t.envName==="align"||t.envName==="alignat",colSeparationType:t.envName,maxNumCols:t.envName==="split"?2:undefined,leqno:t.parser.settings.leqno},"display");let o;let a=0;if(r[0]&&r[0].type==="ordgroup"){let e="";for(let t=0;t<r[0].body.length;t++){const n=ke(r[0].body[t],"textord");e+=n.text}o=Number(e);a=o*2}const i=!a;s.body.forEach((function(t){if(!i){const r=t.length/2;if(o<r){throw new e("Too many math in a row: "+`expected ${o}, but got ${r}`,t[0])}}else if(a<t.length){a=t.length}}));for(let e=0;e<a;++e){let t="r";if(e%2===1){t="l"}n[e]={type:"align",align:t}}s.colSeparationType=i?"align":"alignat";return s};Xe({type:"array",names:["array","darray"],props:{numArgs:1},handler(t,r){const n=ve(r[0]);const s=n?[r[0]]:ke(r[0],"ordgroup").body;const o=s.map((function(t){const r=Ae(t);const n=r.text;if("lcr".indexOf(n)!==-1){return{type:"align",align:n}}else if(n==="|"){return{type:"separator",separator:"|"}}else if(n===":"){return{type:"separator",separator:":"}}throw new e("Unknown column alignment: "+n,t)}));const a={cols:o,colSeparationType:"array",hskipBeforeAndAfter:true,maxNumCols:o.length};return Ke(t.parser,a,Qe(t.envName))},mathmlBuilder:tt});Xe({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(t){const r={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[t.envName.replace("*","")];let n="c";const s={hskipBeforeAndAfter:false,colSeparationType:"matrix",cols:[{type:"align",align:n}]};if(t.envName.charAt(t.envName.length-1)==="*"){const r=t.parser;r.consumeSpaces();if(r.fetch().text==="["){r.consume();r.consumeSpaces();n=r.fetch().text;if("lcr".indexOf(n)===-1){throw new e("Expected l or c or r",r.nextToken)}r.consume();r.consumeSpaces();r.expect("]");r.consume();s.cols=[{type:"align",align:n}]}}const o=Ke(t.parser,s,"text");o.cols=new Array(o.body[0].length).fill({type:"align",align:n});return r?{type:"leftright",mode:t.mode,body:[o],left:r[0],right:r[1],rightColor:undefined}:o},mathmlBuilder:tt});Xe({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){const t={arraystretch:.5};const r=Ke(e.parser,t,"script");r.colSeparationType="small";return r},mathmlBuilder:tt});Xe({type:"array",names:["subarray"],props:{numArgs:1},handler(t,r){const n=ve(r[0]);const s=n?[r[0]]:ke(r[0],"ordgroup").body;const o=s.map((function(t){const r=Ae(t);const n=r.text;if("lc".indexOf(n)!==-1){return{type:"align",align:n}}throw new e("Unknown column alignment: "+n,t)}));if(o.length>1){throw new e("{subarray} can contain only one column")}let a={cols:o,hskipBeforeAndAfter:false,colSeparationType:"array",arraystretch:.5};a=Ke(t.parser,a,"script");if(a.body.length>0&&a.body[0].length>1){throw new e("{subarray} can contain only one column")}return a},mathmlBuilder:tt});Xe({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){const t={arraystretch:1.2,cols:[{type:"align",align:"l"},{type:"align",align:"l"}],colSeparationType:"cases"};const r=Ke(e.parser,t,Qe(e.envName));return{type:"leftright",mode:e.mode,body:[r],left:e.envName.indexOf("r")>-1?".":"\\{",right:e.envName.indexOf("r")>-1?"\\}":".",rightColor:undefined}},mathmlBuilder:tt});Xe({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:rt,mathmlBuilder:tt});Xe({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){if(d.contains(["gather","gather*"],e.envName)){Ze(e)}const t={cols:[{type:"align",align:"c"}],addJot:true,colSeparationType:"gather",addEqnNum:e.envName==="gather",leqno:e.parser.settings.leqno};return Ke(e.parser,t,"display")},mathmlBuilder:tt});Xe({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:rt,mathmlBuilder:tt});Xe({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){Ze(e);const t={addEqnNum:e.envName==="equation",singleRow:true,maxNumCols:1,colSeparationType:"gather",leqno:e.parser.settings.leqno};return Ke(e.parser,t,"display")},mathmlBuilder:tt});Xe({type:"array",names:["multline","multline*"],props:{numArgs:0},handler(e){Ze(e);const t={addEqnNum:e.envName==="multline",maxNumCols:1,colSeparationType:"multline",leqno:e.parser.settings.leqno};return Ke(e.parser,t,"display")},mathmlBuilder:tt});Xe({type:"array",names:["CD"],props:{numArgs:0},handler(e){Ze(e);return Be(e.parser)},mathmlBuilder:tt});b({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:true,allowedInMath:true},handler(t,r){throw new e(`${t.funcName} valid only within array environment`)}});const nt=je;b({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler({parser:t,funcName:r},n){const s=n[0];if(s.type!=="ordgroup"){throw new e("Invalid environment name",s)}let o="";for(let e=0;e<s.body.length;++e){o+=ke(s.body[e],"textord").text}if(r==="\\begin"){if(!nt.hasOwnProperty(o)){throw new e("No such environment: "+o,s)}const r=nt[o];const{args:n,optArgs:a}=t.parseArguments("\\begin{"+o+"}",r);const i={mode:t.mode,envName:o,parser:t};const l=r.handler(i,n,a);t.expect("\\end",false);const u=t.nextToken;const c=ke(t.parseFunction(),"environment");if(c.name!==o){throw new e(`Mismatch: \\begin{${o}} matched by \\end{${c.name}}`,u)}return l}return{type:"environment",mode:t.mode,name:o,nameGroup:s}}});b({type:"envTag",names:["\\env@tag"],props:{numArgs:1,argTypes:["math"]},handler({parser:e},t){return{type:"envTag",mode:e.mode,body:t[0]}},mathmlBuilder(e,t){return new E.MathNode("mrow")}});b({type:"noTag",names:["\\env@notag"],props:{numArgs:0},handler({parser:e}){return{type:"noTag",mode:e.mode}},mathmlBuilder(e,t){return new E.MathNode("mrow")}});function st(e,t){let r;const n=de(e.body,t);if(e.mclass==="minner"){return E.newDocumentFragment(n)}else if(e.mclass==="mord"){if(e.isCharacterBox){r=n[0];r.type="mi"}else{r=new E.MathNode("mi",n)}}else{if(e.isCharacterBox){r=n[0];r.type="mo";if(/[A-Za-z]/.test(e.body[0].text)){r.setAttribute("mathvariant","italic")}}else{r=new E.MathNode("mo",n)}if(e.mclass==="mbin"){r.attributes.lspace="0.22em";r.attributes.rspace="0.22em"}else if(e.mclass==="mpunct"){r.attributes.lspace="0em";r.attributes.rspace="0.17em"}else if(e.mclass==="mopen"||e.mclass==="mclose"){r.attributes.lspace="0em";r.attributes.rspace="0em"}}return r}b({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:true},handler({parser:e,funcName:t},r){const n=r[0];return{type:"mclass",mode:e.mode,mclass:"m"+t.substr(5),body:x(n),isCharacterBox:d.isCharacterBox(n)}},mathmlBuilder:st});const ot=e=>{const t=e.type==="ordgroup"&&e.body.length?e.body[0]:e;if(t.type==="atom"&&(t.family==="bin"||t.family==="rel")){return"m"+t.family}else{return"mord"}};b({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler({parser:e},t){return{type:"mclass",mode:e.mode,mclass:ot(t[0]),body:x(t[1]),isCharacterBox:d.isCharacterBox(t[1])}}});b({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler({parser:e,funcName:t},r){const n=r[1];const s=r[0];const o={type:"op",mode:n.mode,limits:true,alwaysHandleSupSub:true,parentIsSupSub:false,symbol:false,stack:true,suppressBaseShift:t!=="\\stackrel",body:x(n)};return{type:"supsub",mode:s.mode,base:o,sup:t==="\\underset"?null:s,sub:t==="\\underset"?s:null}},mathmlBuilder:st});const at=(e,t)=>{const r=e.font;const n=t.withFont(r);const s=ge(e.body,n);if(s.children.length===0){return s}const o=s.children[0];if(o.type!=="mi"){return s}const a=o.attributes.mathvariant||"";for(let e=1;e<s.children.length;e++){if(s.children[e].type!=="mi"){return s}const t=s.children[e].attributes.mathvariant||"";if(t!==a){return s}}for(let e=1;e<s.children.length;e++){o.children.push(s.children[e].children[0])}if(s.attributes.mathcolor){o.attributes.mathcolor=s.attributes.mathcolor}return o};const it={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};b({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\up@greek","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\oldstylenums","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:true},handler:({parser:e,funcName:t},r)=>{const n=w(r[0]);let s=t;if(s in it){s=it[s]}return{type:"font",mode:e.mode,font:s.slice(1),body:n}},mathmlBuilder:at});b({type:"mclass",names:["\\bm","\\boldsymbol"],props:{numArgs:1},handler:({parser:e},t)=>{const r=t[0];const n=d.isCharacterBox(r);const s=ot(r);if(s==="mbin"||s==="mrel"){return{type:"mclass",mode:e.mode,mclass:s,body:[{type:"font",mode:e.mode,font:"boldsymbol",body:r}],isCharacterBox:n}}else{return{type:"font",mode:e.mode,font:"boldsymbol",body:r}}}});b({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:true},handler:({parser:e,funcName:t,breakOnTokenText:r},n)=>{const{mode:s}=e;const o=e.parseExpression(true,r);const a=`math${t.slice(1)}`;return{type:"font",mode:s,font:a,body:{type:"ordgroup",mode:e.mode,body:o}}},mathmlBuilder:at});const lt=["display","text","script","scriptscript"];const ut={auto:-1,display:0,text:0,script:1,scriptscript:2};const ct=(e,t)=>{const r=e.style==="auto"?t.incrementStyle():e.style==="display"?t.withStyle(We.TEXT):e.style==="text"?t.withStyle(We.SCRIPT):t.withStyle(We.SCRIPTSCRIPT);let n=new E.MathNode("mfrac",[ge(e.numer,r),ge(e.denom,r)]);if(!e.hasBarLine){n.setAttribute("linethickness","0px")}else if(e.barSize){const r=ze(e.barSize,t);n.setAttribute("linethickness",r.number+r.unit)}if(e.leftDelim!=null||e.rightDelim!=null){const t=[];if(e.leftDelim!=null){const r=new E.MathNode("mo",[new E.TextNode(e.leftDelim.replace("\\",""))]);r.setAttribute("fence","true");t.push(r)}t.push(n);if(e.rightDelim!=null){const r=new E.MathNode("mo",[new E.TextNode(e.rightDelim.replace("\\",""))]);r.setAttribute("fence","true");t.push(r)}n=pe(t)}if(e.style!=="auto"){n=new E.MathNode("mstyle",[n]);n.setAttribute("displaystyle",String(e.style==="display"));n.setAttribute("scriptlevel",ut[e.style])}return n};b({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:true},handler:({parser:e,funcName:t},r)=>{const n=r[0];const s=r[1];let o=false;let a=null;let i=null;let l="auto";switch(t){case"\\dfrac":case"\\frac":case"\\tfrac":o=true;break;case"\\\\atopfrac":o=false;break;case"\\dbinom":case"\\binom":case"\\tbinom":a="(";i=")";break;case"\\\\bracefrac":a="\\{";i="\\}";break;case"\\\\brackfrac":a="[";i="]";break;default:throw new Error("Unrecognized genfrac command")}switch(t){case"\\dfrac":case"\\dbinom":l="display";break;case"\\tfrac":case"\\tbinom":l="text";break}return{type:"genfrac",mode:e.mode,continued:false,numer:n,denom:s,hasBarLine:o,leftDelim:a,rightDelim:i,style:l,barSize:null}},mathmlBuilder:ct});b({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:({parser:e,funcName:t},r)=>{const n=r[0];const s=r[1];return{type:"genfrac",mode:e.mode,continued:true,numer:n,denom:s,hasBarLine:true,leftDelim:null,rightDelim:null,style:"display",barSize:null}}});b({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:true},handler({parser:e,funcName:t,token:r}){let n;switch(t){case"\\over":n="\\frac";break;case"\\choose":n="\\binom";break;case"\\atop":n="\\\\atopfrac";break;case"\\brace":n="\\\\bracefrac";break;case"\\brack":n="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:n,token:r}}});const mt=function(e){let t=null;if(e.length>0){t=e;t=t==="."?null:t}return t};b({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:true,argTypes:["math","math","size","text","math","math"]},handler({parser:e},t){const r=t[4];const n=t[5];const s=w(t[0]);const o=s.type==="atom"&&s.family==="open"?mt(s.text):null;const a=w(t[1]);const i=a.type==="atom"&&a.family==="close"?mt(a.text):null;const l=ke(t[2],"size");let u;let c=null;if(l.isBlank){u=true}else{c=l.value;u=c.number>0}let m="auto";let p=t[3];if(p.type==="ordgroup"){if(p.body.length>0){const e=ke(p.body[0],"textord");m=lt[Number(e.text)]}}else{p=ke(p,"textord");m=lt[Number(p.text)]}return{type:"genfrac",mode:e.mode,numer:r,denom:n,continued:false,hasBarLine:u,barSize:c,leftDelim:o,rightDelim:i,style:m}},mathmlBuilder:ct});b({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:true},handler({parser:e,funcName:t,token:r},n){return{type:"infix",mode:e.mode,replaceWith:"\\\\abovefrac",barSize:ke(n[0],"size").value,token:r}}});b({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:({parser:e,funcName:t},r)=>{const n=r[0];const s=c(ke(r[1],"infix").barSize);const o=r[2];const a=s.number>0;return{type:"genfrac",mode:e.mode,numer:n,denom:o,continued:false,hasBarLine:a,barSize:s,leftDelim:null,rightDelim:null,style:"auto"}},mathmlBuilder:ct});const pt=(e,t)=>{const r=P.mathMLnode(e.label);return new E.MathNode(e.isOver?"mover":"munder",[ge(e.base,t),r])};b({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler({parser:e,funcName:t},r){return{type:"horizBrace",mode:e.mode,label:t,isOver:/^\\over/.test(t),base:r[0]}},mathmlBuilder:pt});b({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:true},handler:({parser:e},t)=>{const r=t[1];const n=ke(t[0],"url").url;if(!e.settings.isTrusted({command:"\\href",url:n})){return e.formatUnsupportedCmd("\\href")}return{type:"href",mode:e.mode,href:n,body:x(r)}},mathmlBuilder:(e,t)=>{let r=he(e.body,t);if(!(r instanceof O)){r=new O("mrow",[r])}r.setAttribute("href",e.href);return r}});b({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:true},handler:({parser:e},t)=>{const r=ke(t[0],"url").url;if(!e.settings.isTrusted({command:"\\url",url:r})){return e.formatUnsupportedCmd("\\url")}const n=[];for(let e=0;e<r.length;e++){let t=r[e];if(t==="~"){t="\\textasciitilde"}n.push({type:"textord",mode:"text",text:t})}const s={type:"text",mode:e.mode,font:"\\texttt",body:n};return{type:"href",mode:e.mode,href:r,body:x(s)}}});b({type:"html",names:["\\class","\\id","\\style","\\data"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:true},handler:({parser:t,funcName:r,token:n},s)=>{const o=ke(s[0],"raw").string;const a=s[1];if(t.settings.strict){t.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode")}let i;const l={};switch(r){case"\\class":l.class=o;i={command:"\\class",class:o};break;case"\\id":l.id=o;i={command:"\\id",id:o};break;case"\\style":l.style=o;i={command:"\\style",style:o};break;case"\\data":{const t=o.split(",");for(let r=0;r<t.length;r++){const n=t[r].split("=");if(n.length!==2){throw new e("Error parsing key-value for \\data")}l["data-"+n[0].trim()]=n[1].trim()}i={command:"\\data",attributes:l};break}default:throw new Error("Unrecognized html command")}if(!t.settings.isTrusted(i)){return t.formatUnsupportedCmd(r)}return{type:"html",mode:t.mode,attributes:l,body:x(a)}},mathmlBuilder:(e,t)=>{const r=he(e.body,t);const n=[];if(e.attributes.class){n.push(...e.attributes.class.trim().split(/\s+/))}r.classes=n;for(const t in e.attributes){if(t!=="class"&&Object.prototype.hasOwnProperty.call(e.attributes,t)){r.setAttribute(t,e.attributes[t])}}return r}});const dt=function(t){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(t)){return{number:+t,unit:"bp"}}else{const r=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t);if(!r){throw new e("Invalid size: '"+t+"' in \\includegraphics")}const n={number:+(r[1]+r[2]),unit:r[3]};if(!Ie(n)){throw new e("Invalid unit: '"+n.unit+"' in \\includegraphics.")}return n}};b({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:false},handler:({parser:t},r,n)=>{let s={number:0,unit:"em"};let o={number:.9,unit:"em"};let a={number:0,unit:"em"};let i="";if(n[0]){const t=ke(n[0],"raw").string;const r=t.split(",");for(let t=0;t<r.length;t++){const n=r[t].split("=");if(n.length===2){const t=n[1].trim();switch(n[0].trim()){case"alt":i=t;break;case"width":s=dt(t);break;case"height":o=dt(t);break;case"totalheight":a=dt(t);break;default:throw new e("Invalid key: '"+n[0]+"' in \\includegraphics.")}}}}const l=ke(r[0],"url").url;if(i===""){i=l;i=i.replace(/^.*[\\/]/,"");i=i.substring(0,i.lastIndexOf("."))}if(!t.settings.isTrusted({command:"\\includegraphics",url:l})){return t.formatUnsupportedCmd("\\includegraphics")}return{type:"includegraphics",mode:t.mode,alt:i,width:s,height:o,totalheight:a,src:l}},mathmlBuilder:(e,t)=>{const r=ze(e.height,t);const n={number:0,unit:"em"};if(e.totalheight.number>0){if(e.totalheight.unit===r.unit&&e.totalheight.number>r.number){n.number=e.totalheight.number-r.number;n.unit=r.unit}}let s=0;if(e.width.number>0){s=ze(e.width,t)}const o={height:r.number+n.number+"em"};if(s.number>0){o.width=s.number+s.unit}if(n.number>0){o.verticalAlign=-n.number+n.unit}const a=new M(e.src,e.alt,o);a.height=r;a.depth=n;return new E.MathNode("mtext",[a])}});b({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:true,allowedInText:true},handler({parser:e,funcName:t},r){const n=ke(r[0],"size");if(e.settings.strict){const r=t[1]==="m";const s=n.value.unit==="mu";if(r){if(!s){e.settings.reportNonstrict("mathVsTextUnits",`LaTeX's ${t} supports only mu units, `+`not ${n.value.unit} units`)}if(e.mode!=="math"){e.settings.reportNonstrict("mathVsTextUnits",`LaTeX's ${t} works only in math mode`)}}else{if(s){e.settings.reportNonstrict("mathVsTextUnits",`LaTeX's ${t} doesn't support mu units`)}}}return{type:"kern",mode:e.mode,dimension:n.value}},mathmlBuilder(e,t){const r=ze(e.dimension,t);const n=r.unit==="em"?ht(r.number):"";if(e.mode==="text"&&n.length>0){const e=new E.TextNode(n);return new E.MathNode("mtext",[e])}else{const e=new E.MathNode("mspace");e.setAttribute("width",r.number+r.unit);return e}}});const ht=function(e){if(e>=.05555&&e<=.05556){return" "}else if(e>=.1666&&e<=.1667){return" "}else if(e>=.2222&&e<=.2223){return" "}else if(e>=.2777&&e<=.2778){return"  "}else{return""}};const gt=/[^A-Za-z_0-9-]/g;b({type:"label",names:["\\label"],props:{numArgs:1,argTypes:["raw"]},handler({parser:e},t){return{type:"label",mode:e.mode,string:t[0].string.replace(gt,"")}},mathmlBuilder(e,t){const r=new E.MathNode("mrow",[],["tml-label"]);if(e.string.length>0){r.setAttribute("id",e.string)}return r}});b({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:true},handler:({parser:e,funcName:t},r)=>{const n=r[0];return{type:"lap",mode:e.mode,alignment:t.slice(5),body:n}},mathmlBuilder:(e,t)=>{const r=new E.MathNode("mpadded",[ge(e.body,t)]);if(e.alignment!=="rlap"){const t=e.alignment==="llap"?"-1":"-0.5";r.setAttribute("lspace",t+"width")}r.setAttribute("width","0px");return r}});b({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:true,allowedInMath:false},handler({funcName:e,parser:t},r){const n=t.mode;t.switchMode("math");const s=e==="\\("?"\\)":"$";const o=t.parseExpression(false,s);t.expect(s);t.switchMode(n);return{type:"styling",mode:t.mode,style:"text",body:o}}});b({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:true,allowedInMath:false},handler(t,r){throw new e(`Mismatched ${t.funcName}`)}});const ft=(e,t)=>{switch(t.style){case We.DISPLAY:return e.display;case We.TEXT:return e.text;case We.SCRIPT:return e.script;case We.SCRIPTSCRIPT:return e.scriptscript;default:return e.text}};b({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:true},handler:({parser:e},t)=>({type:"mathchoice",mode:e.mode,display:x(t[0]),text:x(t[1]),script:x(t[2]),scriptscript:x(t[3])}),mathmlBuilder:(e,t)=>{const r=ft(e,t);return he(r,t)}});const bt=(e,t,r)=>{if(!e){return r}const n=ge(e,t);if(n.type==="mrow"&&n.children.length===0){return r}return n};b({type:"multiscript",names:["\\sideset","\\pres@cript"],props:{numArgs:3},handler({parser:t,funcName:r},n){if(n[2].body.length===0){throw new e(r+`cannot parse an empty base.`)}const s=n[2].body[0];if(t.settings.strict&&r==="\\sideset"&&!s.symbol){throw new e(`The base of \\sideset must be a big operator.`)}if(n[0].body.length>0&&n[0].body[0].type!=="supsub"||n[1].body.length>0&&n[1].body[0].type!=="supsub"){throw new e("\\sideset can parse only subscripts and "+"superscripts in its first two arguments")}const o=n[0].body.length>0?n[0].body[0]:null;const a=n[1].body.length>0?n[1].body[0]:null;if(!o&!a){return s}else if(!o){return{type:"styling",mode:t.mode,style:"text",body:[{type:"supsub",mode:t.mode,base:s,sup:a.sup,sub:a.sub}]}}else{return{type:"multiscript",mode:t.mode,prescripts:o,postscripts:a,base:s}}},mathmlBuilder(e,t){const r=ge(e.base,t);const n=new E.MathNode("mprescripts");const s=new E.MathNode("none");let o=[];const a=bt(e.prescripts.sub,t,s);const i=bt(e.prescripts.sup,t,s);a.setAttribute("style","text-align: left;");i.setAttribute("style","text-align: left;");if(e.postscripts){const l=bt(e.postscripts.sub,t,s);const u=bt(e.postscripts.sup,t,s);o=[r,l,u,n,a,i]}else{o=[r,n,a,i]}return new E.MathNode("mmultiscripts",o)}});b({type:"newExtArrow",names:["\\ext@arrow"],props:{numArgs:4,argTypes:["raw","raw","raw","math"]},handler({parser:e},t){return{type:"newExtArrow",mode:e.mode,lspace:d.round(Number(t[0].string.trim())/18),rspace:d.round(Number(t[1].string.trim())/18),charCode:Number(t[2].string.trim()),body:t[3]}},mathmlBuilder(e,t){const r=new E.MathNode("mo",[new E.TextNode(String.fromCodePoint(e.charCode))]);r.setAttribute("stretchy","true");r.setAttribute("minsize","1.75em");let n;if(e.body){let s=ge(e.body,t.incrementStyle());s=new E.MathNode("mpadded",[s]);s.setAttribute("width","+"+(e.lspace+e.rspace)+"em");s.setAttribute("lspace",e.lspace+"em");n=new E.MathNode("mover",[r,s])}else{n=paddedNode();n=new E.MathNode("mover",[r,n])}return n}});b({type:"not",names:["\\not"],props:{numArgs:1,primitive:true,allowedInText:false},handler({parser:e},t){const r=d.isCharacterBox(t[0]);let n;if(r){n=x(t[0]);if(n[0].text.charAt(0)==="\\"){n[0].text=V.math[n[0].text].replace}n[0].text=n[0].text.slice(0,1)+"̸"+n[0].text.slice(1)}else{const e={type:"textord",mode:"math",text:"̸"};const r={type:"kern",mode:"math",dimension:{number:-.6,unit:"em"}};n=[e,r,t[0]]}return{type:"not",mode:e.mode,body:n,isCharacterBox:r}},mathmlBuilder(e,t){if(e.isCharacterBox){const r=de(e.body,t);return r[0]}else{return he(e.body,t,true)}}});const yt=["\\smallint"];const wt=["textord","mathord","ordgroup","close","leftright"];const xt=(e,t)=>{let r;if(e.symbol){r=new O("mo",[me(e.name,e.mode)]);if(d.contains(yt,e.name)){r.setAttribute("largeop","false")}}else if(e.body){r=new O("mo",de(e.body,t))}else{r=new O("mi",[new C(e.name.slice(1))]);if(!e.parentIsSupSub){const t=new O("mo",[me("⁡","text")]);if(e.needsLeadingSpace){const e=new O("mspace");e.setAttribute("width","0.1667em");r=B([e,r,t])}else{r=B([r,t])}}}return r};const kt={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨅":"\\bigsqcap","⨆":"\\bigsqcup"};b({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcap","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:({parser:e,funcName:t},r)=>{let n=t;if(n.length===1){n=kt[n]}return{type:"op",mode:e.mode,limits:true,parentIsSupSub:false,symbol:true,stack:false,name:n}},mathmlBuilder:xt});b({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:true},handler:({parser:e},t)=>{const r=t[0];return{type:"op",mode:e.mode,limits:false,parentIsSupSub:false,symbol:false,stack:false,body:x(r)}},mathmlBuilder:xt});const At={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint","∱":"\\intclockwise","∲":"\\varointclockwise","⨌":"\\iiiint","⨍":"\\intbar","⨎":"\\intBar","⨏":"\\fint","⨒":"\\rppolint","⨓":"\\scpolint","⨕":"\\pointint","⨖":"\\sqint","⨗":"\\intlarhk","⨘":"\\intx","⨙":"\\intcap","⨚":"\\intcup"};b({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler({parser:e,funcName:t}){const r=e.prevAtomType;return{type:"op",mode:e.mode,limits:false,parentIsSupSub:false,symbol:false,stack:false,needsLeadingSpace:r.length>0&&d.contains(wt,r),name:t}},mathmlBuilder:xt});b({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler({parser:e,funcName:t}){const r=e.prevAtomType;return{type:"op",mode:e.mode,limits:true,parentIsSupSub:false,symbol:false,stack:false,needsLeadingSpace:r.length>0&&d.contains(wt,r),name:t}},mathmlBuilder:xt});b({type:"op",names:["\\int","\\iint","\\iiint","\\iiiint","\\oint","\\oiint","\\oiiint","\\intclockwise","\\varointclockwise","\\intbar","\\intBar","\\fint","\\rppolint","\\scpolint","\\pointint","\\sqint","\\intlarhk","\\intx","\\intcap","\\intcup","∫","∬","∭","∮","∯","∰","∱","∲","⨌","⨍","⨎","⨏","⨒","⨓","⨕","⨖","⨗","⨘","⨙","⨚"],props:{numArgs:0},handler({parser:e,funcName:t}){let r=t;if(r.length===1){r=At[r]}return{type:"op",mode:e.mode,limits:false,parentIsSupSub:false,symbol:true,stack:false,name:r}},mathmlBuilder:xt});const vt=(e,t)=>{let r=de(e.body,t.withFont("mathrm"));let n=true;for(let e=0;e<r.length;e++){const t=r[e];if(t instanceof E.MathNode){switch(t.type){case"mi":case"mn":case"ms":case"mtext":break;case"mspace":{if(t.attributes.width){const s=t.attributes.width.replace("em","");const o=ht(Number(s));if(o===""){n=false}else{r[e]=new E.MathNode("mtext",[new E.TextNode(o)])}}}break;case"mo":{const e=t.children[0];if(t.children.length===1&&e instanceof E.TextNode){e.text=e.text.replace(/\u2212/,"-").replace(/\u2217/,"*")}else{n=false}break}default:n=false}}else{n=false}}if(n){const e=r.map((e=>e.toText())).join("");r=[new E.TextNode(e)]}else if(r.length===1&&d.contains(["mover","munder"],r[0].type)&&r[0].children[0].type==="mi"){const e=new E.MathNode("mo",[me("⁡","text")]);return E.newDocumentFragment([r[0],e])}const s=new E.MathNode("mi",r);s.setAttribute("mathvariant","normal");if(!e.parentIsSupSub){const t=new E.MathNode("mo",[me("⁡","text")]);if(e.needsLeadingSpace){const e=new E.MathNode("mspace");e.setAttribute("width","0.1667em");return E.newDocumentFragment([e,s,t])}else{return E.newDocumentFragment([s,t])}}return s};b({type:"operatorname",names:["\\operatorname","\\operatorname*"],props:{numArgs:1},handler:({parser:e,funcName:t},r)=>{const n=r[0];const s=e.prevAtomType;return{type:"operatorname",mode:e.mode,body:x(n),alwaysHandleSupSub:t==="\\operatorname*",limits:false,parentIsSupSub:false,needsLeadingSpace:s.length>0&&d.contains(wt,s)}},mathmlBuilder:vt});y({type:"ordgroup",mathmlBuilder(e,t){return he(e.body,t,true)}});b({type:"overline",names:["\\overline"],props:{numArgs:1},handler({parser:e},t){const r=t[0];return{type:"overline",mode:e.mode,body:r}},mathmlBuilder(e,t){const r=new E.MathNode("mo",[new E.TextNode("‾")]);r.setAttribute("stretchy","true");const n=new E.MathNode("mover",[ge(e.body,t),r]);n.setAttribute("accent","true");return n}});b({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:true},handler:({parser:e},t)=>{const r=t[0];return{type:"phantom",mode:e.mode,body:x(r)}},mathmlBuilder:(e,t)=>{const r=de(e.body,t);return new E.MathNode("mphantom",r)}});b({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:true},handler:({parser:e},t)=>{const r=t[0];return{type:"hphantom",mode:e.mode,body:r}},mathmlBuilder:(e,t)=>{const r=de(x(e.body),t);const n=new E.MathNode("mphantom",r);const s=new E.MathNode("mpadded",[n]);s.setAttribute("height","0px");s.setAttribute("depth","0px");return s}});b({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:true},handler:({parser:e},t)=>{const r=t[0];return{type:"vphantom",mode:e.mode,body:r}},mathmlBuilder:(e,t)=>{const r=de(x(e.body),t);const n=new E.MathNode("mphantom",r);const s=new E.MathNode("mpadded",[n]);s.setAttribute("width","0px");return s}});const Tt=e=>e>=0?"+":"-";const Nt=(e,t)=>{const r=t.withStyle(We.TEXT);const n=new E.MathNode("mpadded",[ge(e.body,r)]);const s=ze(e.dy,t);n.setAttribute("voffset",s.number+s.unit);const o=Math.abs(s.number);n.setAttribute("height",Tt(s.number)+o+s.unit);n.setAttribute("depth",Tt(-s.number)+o+s.unit);return n};b({type:"raise",names:["\\raise","\\lower"],props:{numArgs:2,argTypes:["size","primitive"],primitive:true},handler({parser:e,funcName:t},r){const n=ke(r[0],"size").value;if(t==="\\lower"){n.number*=-1}const s=r[1];return{type:"raise",mode:e.mode,dy:n,body:s}},mathmlBuilder:Nt});b({type:"raise",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:true},handler({parser:e,funcName:t},r){const n=ke(r[0],"size").value;const s=r[1];return{type:"raise",mode:e.mode,dy:n,body:s}},mathmlBuilder:Nt});b({type:"ref",names:["\\ref","\\eqref"],props:{numArgs:1,argTypes:["raw"]},handler({parser:e,funcName:t},r){return{type:"ref",mode:e.mode,funcName:t,string:r[0].string.replace(gt,"")}},mathmlBuilder(e,t){const r=e.funcName==="\\ref"?["tml-ref"]:["tml-ref","tml-eqref"];const n=new E.MathNode("mtext",[new E.TextNode("")],r);n.setAttribute("href","#"+e.string);return n}});b({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,argTypes:["size","size","size"]},handler({parser:e},t,r){const n=r[0];const s=ke(t[0],"size");const o=ke(t[1],"size");return{type:"rule",mode:e.mode,shift:n&&ke(n,"size").value,width:s.value,height:o.value}},mathmlBuilder(e,t){const r=ze(e.width,t);const n=ze(e.height,t);const s=e.shift?ze(e.shift,t):{number:0,unit:"em"};const o=t.color&&t.getColor()||"black";const a=new E.MathNode("mspace");a.setAttribute("mathbackground",o);a.setAttribute("width",r.number+r.unit);a.setAttribute("height",n.number+n.unit);const i=new E.MathNode("mpadded",[a]);if(s.number>=0){i.setAttribute("height","+"+s.number+s.unit)}else{i.setAttribute("height",s.number+s.unit);i.setAttribute("depth","+"+-s.number+s.unit)}i.setAttribute("voffset",s.number+s.unit);return i}});const St={"\\tiny":.5,"\\sixptsize":.6,"\\Tiny":.6,"\\scriptsize":.7,"\\footnotesize":.8,"\\small":.9,"\\normalsize":1,"\\large":1.2,"\\Large":1.44,"\\LARGE":1.728,"\\huge":2.074,"\\Huge":2.488};b({type:"sizing",names:["\\tiny","\\sixptsize","\\Tiny","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],props:{numArgs:0,allowedInText:true},handler:({breakOnTokenText:e,funcName:t,parser:r},n)=>{const s=r.parseExpression(false,e);return{type:"sizing",mode:r.mode,funcName:t,body:s}},mathmlBuilder:(e,t)=>{const r=de(e.body,t);const n=new E.MathNode("mstyle",r);n.setAttribute("mathsize",St[e.funcName]+"em");return n}});b({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:true},handler:({parser:e},t,r)=>{let n=false;let s=false;const o=r[0]&&ke(r[0],"ordgroup");if(o){let e="";for(let t=0;t<o.body.length;++t){const r=o.body[t];e=r.text;if(e==="t"){n=true}else if(e==="b"){s=true}else{n=false;s=false;break}}}else{n=true;s=true}const a=t[0];return{type:"smash",mode:e.mode,body:a,smashHeight:n,smashDepth:s}},mathmlBuilder:(e,t)=>{const r=new E.MathNode("mpadded",[ge(e.body,t)]);if(e.smashHeight){r.setAttribute("height","0px")}if(e.smashDepth){r.setAttribute("depth","0px")}return r}});b({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler({parser:e},t,r){const n=r[0];const s=t[0];return{type:"sqrt",mode:e.mode,body:s,index:n}},mathmlBuilder(e,t){const{body:r,index:n}=e;return n?new E.MathNode("mroot",[ge(r,t),ge(n,t.incrementStyle())]):new E.MathNode("msqrt",[ge(r,t)])}});const qt={display:0,text:1,script:2,scriptscript:3};b({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:true,primitive:true},handler({breakOnTokenText:e,funcName:t,parser:r},n){const s=r.parseExpression(true,e);const o=t.slice(1,t.length-5);return{type:"styling",mode:r.mode,style:o,body:s}},mathmlBuilder(e,t){const r=t.withStyle(qt[e.style]);const n=de(e.body,r);const s=new E.MathNode("mstyle",n);const o={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]};const a=o[e.style];s.setAttribute("scriptlevel",a[0]);s.setAttribute("displaystyle",a[1]);return s}});y({type:"supsub",mathmlBuilder(e,t){let r=false;let n;let s;let o=false;let a=false;if(e.base&&e.base.type==="horizBrace"){s=!!e.sup;if(s===e.base.isOver){r=true;n=e.base.isOver}}if(e.base&&!e.base.stack&&(e.base.type==="op"||e.base.type==="operatorname")){e.base.parentIsSupSub=true;o=!e.base.symbol;a=e.base.needsLeadingSpace}const i=e.base&&e.base.stack?[ge(e.base.body[0],t)]:[ge(e.base,t)];const l=t.incrementStyle();if(e.sub){i.push(ge(e.sub,l))}if(e.sup){i.push(ge(e.sup,l))}let u;if(r){u=n?"mover":"munder"}else if(!e.sub){const r=e.base;if(r&&r.type==="op"&&r.limits&&(t.style===We.DISPLAY||r.alwaysHandleSupSub)){u="mover"}else if(r&&r.type==="operatorname"&&r.alwaysHandleSupSub&&(r.limits||t.style===We.DISPLAY)){u="mover"}else{u="msup"}}else if(!e.sup){const r=e.base;if(r&&r.type==="op"&&r.limits&&(t.style===We.DISPLAY||r.alwaysHandleSupSub)){u="munder"}else if(r&&r.type==="operatorname"&&r.alwaysHandleSupSub&&(r.limits||t.style===We.DISPLAY)){u="munder"}else{u="msub"}}else{const r=e.base;if(r&&r.type==="op"&&r.limits&&t.style===We.DISPLAY){u="munderover"}else if(r&&r.type==="operatorname"&&r.alwaysHandleSupSub&&(t.style===We.DISPLAY||r.limits)){u="munderover"}else{u="msubsup"}}let c=new E.MathNode(u,i);if(o){const e=new E.MathNode("mo",[me("⁡","text")]);if(a){const t=new E.MathNode("mspace");t.setAttribute("width","0.1667em");c=E.newDocumentFragment([t,c,e])}else{c=E.newDocumentFragment([c,e])}}return c}});const Mt={mathbf:"bold",mathrm:"normal",textit:"italic",mathit:"italic",mathnormal:"italic",mathbb:"double-struck",mathcal:"script",mathfrak:"fraktur",mathscr:"script",mathsf:"sans-serif",mathtt:"monospace",oldstylenums:"oldstylenums"};const Bt=function(e,t){if(t.fontFamily==="texttt"){return"monospace"}else if(t.fontFamily==="textsc"){return"normal"}else if(t.fontFamily==="textsf"){if(t.fontShape==="textit"&&t.fontWeight==="textbf"){return"sans-serif-bold-italic"}else if(t.fontShape==="textit"){return"sans-serif-italic"}else if(t.fontWeight==="textbf"){return"bold-sans-serif"}else{return"sans-serif"}}else if(t.fontShape==="textit"&&t.fontWeight==="textbf"){return"bold-italic"}else if(t.fontShape==="textit"){return"italic"}else if(t.fontWeight==="textbf"){return"bold"}const r=t.font;if(!r||r==="mathnormal"){return null}const n=e.mode;switch(r){case"mathit":return"italic";case"mathrm":{const t=e.text.codePointAt(0);return 939<t&&t<975?"lowerCaseGreekItalic":"normal"}case"greekItalic":return"greekItalic";case"up@greek":return"normal";case"boldsymbol":case"mathboldsymbol":return e.type==="textord"?"bold":"bold-italic";case"mathbf":return"bold";case"mathbb":return"double-struck";case"mathfrak":return"fraktur";case"mathscr":case"mathcal":return"script";case"mathsf":return"sans-serif";case"mathtt":return"monospace";case"oldstylenums":return"oldstylenums"}let s=e.text;if(V[n][s]&&V[n][s].replace){s=V[n][s].replace}return Object.prototype.hasOwnProperty.call(Mt,r)?Mt[r]:null};y({type:"atom",mathmlBuilder(e,t){const r=new E.MathNode("mo",[me(e.text,e.mode)]);if(e.family==="bin"){const n=Bt(e,t);if(n==="bold-italic"){r.setAttribute("mathvariant",n)}}else if(e.family==="punct"){r.setAttribute("separator","true")}else if(e.family==="open"||e.family==="close"||e.family==="rel"){r.setAttribute("stretchy","false");if(e.family==="open"){r.setAttribute("form","prefix")}else if(e.family==="close"){r.setAttribute("form","postfix")}}return r}});const Ot={mi:"italic",mn:"normal",mtext:"normal"};const Ct=/^\d[\d.]*$/;const Et={a:"ᴀ",b:"ʙ",c:"ᴄ",d:"ᴅ",e:"ᴇ",f:"ꜰ",g:"ɢ",h:"ʜ",i:"ɪ",j:"ᴊ",k:"ᴋ",l:"ʟ",m:"ᴍ",n:"ɴ",o:"ᴏ",p:"ᴘ",q:"ǫ",r:"ʀ",s:"s",t:"ᴛ",u:"ᴜ",v:"ᴠ",w:"ᴡ",x:"x",y:"ʏ",z:"ᴢ"};y({type:"mathord",mathmlBuilder(e,t){const r=Bt(e,t)||"italic";const n=me(e.text,e.mode,t);if(r==="script"&&t.font==="mathscr"){const e=new S(["script"],[n]);return new E.MathNode("mi",[e])}const s=new E.MathNode("mi",[n]);if(r==="lowerCaseGreekItalic"){s.setAttribute("mathvariant","italic")}else if(r!==Ot[s.type]){s.setAttribute("mathvariant",r)}return s}});y({type:"textord",mathmlBuilder(e,t){let r=e.text;const n=r.codePointAt(0);if(t.fontFamily==="textsc"){if(96<n&&n<123){r=Et[r]}}const s=me(r,e.mode,t);const o=Bt(e,t)||"normal";let a;if(e.mode==="text"){a=new E.MathNode("mtext",[s])}else if(Ct.test(e.text)){if(o==="oldstylenums"){const e=new S(["oldstylenums"],[s]);a=new E.MathNode("mn",[e])}else{a=new E.MathNode("mn",[s])}}else if(e.text==="\\prime"){a=new E.MathNode("mo",[s])}else{a=new E.MathNode("mi",[s])}if(o!==Ot[a.type]){a.setAttribute("mathvariant",o)}return a}});const It={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"};const $t={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};y({type:"spacing",mathmlBuilder(t,r){let n;if(Object.prototype.hasOwnProperty.call($t,t.text)){n=new E.MathNode("mtext",[new E.TextNode(" ")]);if($t[t.text].className==="nobreak"){n.setAttribute("linebreak","nobreak")}}else if(Object.prototype.hasOwnProperty.call(It,t.text)){n=new E.MathNode("mo");if(t.text==="\\nobreak"){n.setAttribute("linebreak","nobreak")}}else{throw new e(`Unknown type of space "${t.text}"`)}return n}});y({type:"tag"});const zt={"\\text":undefined,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm","\\textsc":"textsc"};const Dt={"\\textbf":"textbf","\\textmd":"textmd"};const Lt={"\\textit":"textit","\\textup":"textup"};const Ft=(e,t)=>{const r=e.font;if(!r){return t}else if(zt[r]){return t.withTextFontFamily(zt[r])}else if(Dt[r]){return t.withTextFontWeight(Dt[r])}else{return t.withTextFontShape(Lt[r])}};b({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textsc","\\textbf","\\textmd","\\textit","\\textup"],props:{numArgs:1,argTypes:["text"],allowedInArgument:true,allowedInText:true},handler({parser:e,funcName:t},r){const n=r[0];return{type:"text",mode:e.mode,body:x(n),font:t}},mathmlBuilder(e,t){const r=Ft(e,t.withStyle(We.TEXT));const n=he(e.body,r);if(n.type!=="mrow"){return n}if(n.children.length===0){return n}const s=n.children[0];if(!s.attributes||s.type!=="mtext"){return n}const o=s.attributes.mathvariant||"";for(let e=1;e<n.children.length;e++){const t=n.children[e].attributes.mathvariant||"";if(t!==o||n.children[e].type!=="mtext"){return n}}for(let e=1;e<n.children.length;e++){s.children.push(n.children[e].children[0])}return s}});b({type:"tip",names:["\\mathtip"],props:{numArgs:2},handler({parser:e},t){return{type:"tip",mode:e.mode,body:t[0],tip:t[1]}},mathmlBuilder:(e,t)=>{const r=ge(e.body,t);const n=ge(e.tip,t);const s=new E.MathNode("maction",[r,n],["tml-tip"]);s.setAttribute("actiontype","tooltip");return s}});b({type:"tip",names:["\\texttip"],props:{numArgs:2,argTypes:["math","text"]},handler({parser:e},t){return{type:"tip",mode:e.mode,body:t[0],tip:t[1]}},mathmlBuilder:(e,t)=>{const r=ge(e.body,t);const n=ge(e.tip,t);let s="";if(n.type==="mtext"){s=n.children[0].text}else{for(const e of n.children){s+=e.children[0].text}}r.setAttribute("title",s);return r}});y({type:"toggle",mathmlBuilder(e,t){const r=de(e.body,t);const n=new E.MathNode("maction",r,["tml-toggle"]);n.setAttribute("actiontype","toggle");return n}});b({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:true},handler({parser:e},t){return{type:"underline",mode:e.mode,body:t[0]}},mathmlBuilder(e,t){const r=new E.MathNode("mo",[new E.TextNode("‾")]);r.setAttribute("stretchy","true");const n=new E.MathNode("munder",[ge(e.body,t),r]);n.setAttribute("accentunder","true");return n}});b({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["math"],allowedInText:false},handler({parser:e},t){return{type:"vcenter",mode:e.mode,body:t[0]}},mathmlBuilder(e,t){return new E.MathNode("mpadded",[ge(e.body,t)],["vcenter"])}});b({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:true},handler(t,r,n){throw new e("\\verb ended by end of line instead of matching delimiter")},mathmlBuilder(e,t){const r=new E.TextNode(Gt(e));const n=new E.MathNode("mtext",[r]);n.setAttribute("mathvariant","monospace");return n}});const Gt=e=>e.body.replace(/ /g,e.star?"␣":" ");const Pt=g;class Ut{constructor(e,t,r){this.lexer=e;this.start=t;this.end=r}static range(e,t){if(!t){return e&&e.loc}else if(!e||!e.loc||!t.loc||e.loc.lexer!==t.loc.lexer){return null}else{return new Ut(e.loc.lexer,e.loc.start,t.loc.end)}}}class Rt{constructor(e,t){this.text=e;this.loc=t}range(e,t){return new Rt(t,Ut.range(this,e))}}const Vt="[ \r\n\t]";const _t="\\\\[a-zA-Z@]+";const Ht="\\\\[^\ud800-\udfff]";const jt=`${_t}${Vt}*`;const Xt=new RegExp(`^(${_t})${Vt}*$`);const Wt="[̀-ͯ]";const Yt=new RegExp(`${Wt}+$`);const Zt=`(${Vt}+)|`+"(\\d[\\d.]*"+"|[!-\\[\\]-‧‪-퟿豈-￿]"+`${Wt}*`+"|[\ud800-\udbff][\udc00-\udfff]"+`${Wt}*`+"|\\\\verb\\*([^]).*?\\3"+"|\\\\verb([^*a-zA-Z]).*?\\4"+"|\\\\operatorname\\*"+`|${jt}`+`|${Ht})`;class Jt{constructor(e,t){this.input=e;this.settings=t;this.tokenRegex=new RegExp(Zt.replace("\\d[\\d.]*|",t.strict?"":"\\d[\\d.]*|"),"g");this.catcodes={"%":14}}setCatcode(e,t){this.catcodes[e]=t}lex(){const t=this.input;const r=this.tokenRegex.lastIndex;if(r===t.length){return new Rt("EOF",new Ut(this,r,r))}const n=this.tokenRegex.exec(t);if(n===null||n.index!==r){throw new e(`Unexpected character: '${t[r]}'`,new Rt(t[r],new Ut(this,r,r+1)))}let s=n[2]||" ";if(this.catcodes[s]===14){const e=t.indexOf("\n",this.tokenRegex.lastIndex);if(e===-1){this.tokenRegex.lastIndex=t.length;this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would "+"fail because of commenting the end of math mode (e.g. $)")}else{this.tokenRegex.lastIndex=e+1}return this.lex()}const o=s.match(Xt);if(o){s=o[1]}return new Rt(s,new Ut(this,r,this.tokenRegex.lastIndex))}}class Kt{constructor(e={},t={}){this.current=t;this.builtins=e;this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0){throw new e("Unbalanced namespace destruction: attempt "+"to pop global namespace; please report this as a bug")}const t=this.undefStack.pop();for(const e in t){if(t.hasOwnProperty(e)){if(t[e]===undefined){delete this.current[e]}else{this.current[e]=t[e]}}}}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){if(this.current.hasOwnProperty(e)){return this.current[e]}else{return this.builtins[e]}}set(e,t,r=false){if(r){for(let t=0;t<this.undefStack.length;t++){delete this.undefStack[t][e]}if(this.undefStack.length>0){this.undefStack[this.undefStack.length-1][e]=t}}else{const t=this.undefStack[this.undefStack.length-1];if(t&&!t.hasOwnProperty(e)){t[e]=this.current[e]}}this.current[e]=t}}const Qt={};function er(e,t){Qt[e]=t}er("\\noexpand",(function(e){const t=e.popToken();if(e.isExpandable(t.text)){t.noexpand=true;t.treatAsRelax=true}return{tokens:[t],numArgs:0}}));er("\\expandafter",(function(e){const t=e.popToken();e.expandOnce(true);return{tokens:[t],numArgs:0}}));er("\\@firstoftwo",(function(e){const t=e.consumeArgs(2);return{tokens:t[0],numArgs:0}}));er("\\@secondoftwo",(function(e){const t=e.consumeArgs(2);return{tokens:t[1],numArgs:0}}));er("\\@ifnextchar",(function(e){const t=e.consumeArgs(3);e.consumeSpaces();const r=e.future();if(t[0].length===1&&t[0][0].text===r.text){return{tokens:t[1],numArgs:0}}else{return{tokens:t[2],numArgs:0}}}));er("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");er("\\TextOrMath",(function(e){const t=e.consumeArgs(2);if(e.mode==="text"){return{tokens:t[0],numArgs:0}}else{return{tokens:t[1],numArgs:0}}}));const tr=e=>{let t="";for(let r=e.length-1;r>-1;r--){t+=e[r].text}return t};const rr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};const nr=e=>{const t=e.future().text;if(t==="EOF"){return[null,""]}return[rr[t.charAt(0)],t]};const sr=(e,t,r)=>{for(let n=1;n<t.length;n++){const s=rr[t.charAt(n)];e*=r;e+=s}return e};er("\\char",(function(t){let r=t.popToken();let n;let s="";if(r.text==="'"){n=8;r=t.popToken()}else if(r.text==='"'){n=16;r=t.popToken()}else if(r.text==="`"){r=t.popToken();if(r.text[0]==="\\"){s=r.text.charCodeAt(1)}else if(r.text==="EOF"){throw new e("\\char` missing argument")}else{s=r.text.charCodeAt(0)}}else{n=10}if(n){let o=r.text;s=rr[o.charAt(0)];if(s==null||s>=n){throw new e(`Invalid base-${n} digit ${r.text}`)}s=sr(s,o,n);let a;[a,o]=nr(t);while(a!=null&&a<n){s*=n;s+=a;s=sr(s,o,n);t.popToken();[a,o]=nr(t)}}return`\\@char{${s}}`}));er("\\hbox","\\text{#1}");er("\\bgroup","{");er("\\egroup","}");er("\\lq","`");er("\\rq","'");er("\\aa","\\r a");er("\\AA","\\r A");er("\\Bbbk","\\Bbb{k}");er("\\llap","\\mathllap{\\textrm{#1}}");er("\\rlap","\\mathrlap{\\textrm{#1}}");er("\\clap","\\mathclap{\\textrm{#1}}");er("\\mathstrut","\\vphantom{(}");er("\\underbar","\\underline{\\text{#1}}");er("\\vdots","\\mathord{\\varvdots\\rule{0pt}{15pt}}");er("⋮","\\vdots");er("\\substack","\\begin{subarray}{c}#1\\end{subarray}");er("\\colon","\\nobreak\\mskip2mu\\mathpunct{}"+"\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu");er("\\boxed","\\fbox{$\\displaystyle{#1}$}");er("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");er("\\implies","\\DOTSB\\;\\Longrightarrow\\;");er("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");const or={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcap":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};er("\\dots",(function(e){let t="\\dotso";const r=e.expandAfterFuture().text;if(r in or){t=or[r]}else if(r.substr(0,4)==="\\not"){t="\\dotsb"}else if(r in V.math){if(d.contains(["bin","rel"],V.math[r].group)){t="\\dotsb"}}return t}));const ar={")":true,"]":true,"\\rbrack":true,"\\}":true,"\\rbrace":true,"\\rangle":true,"\\rceil":true,"\\rfloor":true,"\\rgroup":true,"\\rmoustache":true,"\\right":true,"\\bigr":true,"\\biggr":true,"\\Bigr":true,"\\Biggr":true,$:true,";":true,".":true,",":true};er("\\dotso",(function(e){const t=e.future().text;if(t in ar){return"\\ldots\\,"}else{return"\\ldots"}}));er("\\dotsc",(function(e){const t=e.future().text;if(t in ar&&t!==","){return"\\ldots\\,"}else{return"\\ldots"}}));er("\\cdots",(function(e){const t=e.future().text;if(t in ar){return"\\@cdots\\,"}else{return"\\@cdots"}}));er("\\dotsb","\\cdots");er("\\dotsm","\\cdots");er("\\dotsi","\\!\\cdots");er("\\idotsint","\\dotsi");er("\\dotsx","\\ldots\\,");er("\\DOTSI","\\relax");er("\\DOTSB","\\relax");er("\\DOTSX","\\relax");er("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");er("\\,","\\tmspace+{3mu}{.1667em}");er("\\thinspace","\\,");er("\\>","\\mskip{4mu}");er("\\:","\\tmspace+{4mu}{.2222em}");er("\\medspace","\\:");er("\\;","\\tmspace+{5mu}{.2777em}");er("\\thickspace","\\;");er("\\!","\\tmspace-{3mu}{.1667em}");er("\\negthinspace","\\!");er("\\negmedspace","\\tmspace-{4mu}{.2222em}");er("\\negthickspace","\\tmspace-{5mu}{.277em}");er("\\enspace","\\kern.5em ");er("\\enskip","\\hskip.5em\\relax");er("\\quad","\\hskip1em\\relax");er("\\qquad","\\hskip2em\\relax");er("\\tag","\\@ifstar\\tag@literal\\tag@paren");er("\\tag@paren","\\tag@literal{({#1})}");er("\\tag@literal",(t=>{if(t.macros.get("\\df@tag")){throw new e("Multiple \\tag")}return"\\gdef\\df@tag{\\text{#1}}"}));er("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}"+"\\mathbin{\\rm mod}"+"\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");er("\\pod","\\allowbreak"+"\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");er("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");er("\\mod","\\allowbreak"+"\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}"+"{\\rm mod}\\,\\,#1");er("\\pmb","\\mathbf{#1}");er("\\newline","\\\\\\relax");er("\\TeX","\\textrm{T}\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125em\\textrm{X}");er("\\LaTeX","\\textrm{L}\\kern-.35em\\raisebox{0.2em}{\\scriptstyle A}\\kern-.15em\\TeX");er("\\Temml","\\textrm{T}\\kern-0.2em\\lower{0.2em}\\textrm{E}\\kern-0.08em{\\textrm{M}\\kern-0.08em\\raise{0.2em}\\textrm{M}\\kern-0.08em\\textrm{L}}");er("\\hspace","\\@ifstar\\@hspacer\\@hspace");er("\\@hspace","\\hskip #1\\relax");er("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");er("\\prescript","\\pres@cript{_{#1}^{#2}}{}{#3}");er("\\ordinarycolon",":");er("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");er("\\coloneq",'\\mathop{\\char"3a\\char"2212}');er("\\Coloneq",'\\mathop{\\char"2237\\char"2212}');er("\\Eqqcolon",'\\mathop{\\char"3d\\char"2237}');er("\\Eqcolon",'\\mathop{\\char"2212\\char"2237}');er("\\colonapprox",'\\mathop{\\char"3a\\char"2248}');er("\\Colonapprox",'\\mathop{\\char"2237\\char"2248}');er("\\colonsim",'\\mathop{\\char"3a\\char"223c}');er("\\Colonsim",'\\mathop{\\char"2237\\char"223c}');er("\\ratio","\\vcentcolon");er("\\coloncolon","\\dblcolon");er("\\colonequals","\\coloneqq");er("\\coloncolonequals","\\Coloneqq");er("\\equalscolon","\\eqqcolon");er("\\equalscoloncolon","\\Eqqcolon");er("\\colonminus","\\coloneq");er("\\coloncolonminus","\\Coloneq");er("\\minuscolon","\\eqcolon");er("\\minuscoloncolon","\\Eqcolon");er("\\coloncolonapprox","\\Colonapprox");er("\\coloncolonsim","\\Colonsim");er("\\notni","\\mathrel{\\char`∌}");er("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");er("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");er("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");er("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");er("\\varlimsup","\\DOTSB\\operatorname*{\\overline{\\mathrm{lim}}}");er("\\varliminf","\\DOTSB\\operatorname*{\\underline{\\mathrm{lim}}}");er("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{\\mathrm{lim}}}");er("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{\\mathrm{lim}}}");er("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");er("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");er("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");er("\\bra","\\mathinner{\\langle{#1}|}");er("\\ket","\\mathinner{|{#1}\\rangle}");er("\\braket","\\mathinner{\\langle{#1}\\rangle}");er("\\Bra","\\left\\langle#1\\right|");er("\\Ket","\\left|#1\\right\\rangle");er("\\angln","{\\angl n}");er("\\newextarrow",(function(t){const r=t.consumeArgs(3);const n=r[0][0].text;const s=tr(r[1]);const o=s.split(",");if(o.length!==2||isNaN(o[0]||isNaN(o[1]))){throw new e("Invalid lspace,rspace in \\newextarrow.")}const a=tr(r[2]);if(isNaN(a)){throw new e("Invalid Unicode character code in \\newextarrow.")}er(n,`\\ext@arrow{${o[0]}}{${o[1]}}{${a}}{#1}`);return""}));er("\\upalpha","\\up@greek{\\alpha}");er("\\upbeta","\\up@greek{\\beta}");er("\\upgamma","\\up@greek{\\gamma}");er("\\updelta","\\up@greek{\\delta}");er("\\upepsilon","\\up@greek{\\epsilon}");er("\\upzeta","\\up@greek{\\zeta}");er("\\upeta","\\up@greek{\\eta}");er("\\uptheta","\\up@greek{\\theta}");er("\\upiota","\\up@greek{\\iota}");er("\\upkappa","\\up@greek{\\kappa}");er("\\uplambda","\\up@greek{\\lambda}");er("\\upmu","\\up@greek{\\mu}");er("\\upnu","\\up@greek{\\nu}");er("\\upxi","\\up@greek{\\xi}");er("\\upomicron","\\up@greek{\\omicron}");er("\\uppi","\\up@greek{\\pi}");er("\\upalpha","\\up@greek{\\alpha}");er("\\uprho","\\up@greek{\\rho}");er("\\upsigma","\\up@greek{\\sigma}");er("\\uptau","\\up@greek{\\tau}");er("\\upupsilon","\\up@greek{\\upsilon}");er("\\upphi","\\up@greek{\\phi}");er("\\upchi","\\up@greek{\\chi}");er("\\uppsi","\\up@greek{\\psi}");er("\\upomega","\\up@greek{\\omega}");er("\\standardstate","{\\tiny\\char`⦵}");const ir={"\\relax":true,"^":true,_:true,"\\limits":true,"\\nolimits":true};class lr{constructor(e,t,r){this.settings=t;this.expansionCount=0;this.feed(e);this.macros=new Kt(Qt,t.macros);this.mode=r;this.stack=[]}feed(e){this.lexer=new Jt(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}future(){if(this.stack.length===0){this.pushToken(this.lexer.lex())}return this.stack[this.stack.length-1]}popToken(){this.future();return this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){let t;let r;let n;if(e){this.consumeSpaces();if(this.future().text!=="["){return null}t=this.popToken();({tokens:n,end:r}=this.consumeArg(["]"]))}else{({tokens:n,start:t,end:r}=this.consumeArg())}this.pushToken(new Rt("EOF",r.loc));this.pushTokens(n);return t.range(r,"")}consumeSpaces(){for(;;){const e=this.future();if(e.text===" "){this.stack.pop()}else{break}}}consumeArg(t){const r=[];const n=t&&t.length>0;if(!n){this.consumeSpaces()}const s=this.future();let o;let a=0;let i=0;do{o=this.popToken();r.push(o);if(o.text==="{"){++a}else if(o.text==="}"){--a;if(a===-1){throw new e("Extra }",o)}}else if(o.text==="EOF"){throw new e("Unexpected end of input in a macro argument"+", expected '"+(t&&n?t[i]:"}")+"'",o)}if(t&&n){if((a===0||a===1&&t[i]==="{")&&o.text===t[i]){++i;if(i===t.length){r.splice(-i,i);break}}else{i=0}}}while(a!==0||n);if(s.text==="{"&&r[r.length-1].text==="}"){r.pop();r.shift()}r.reverse();return{tokens:r,start:s,end:o}}consumeArgs(t,r){if(r){if(r.length!==t+1){throw new e("The length of delimiters doesn't match the number of args!")}const n=r[0];for(let t=0;t<n.length;t++){const r=this.popToken();if(n[t]!==r.text){throw new e("Use of the macro doesn't match its definition",r)}}}const n=[];for(let e=0;e<t;e++){n.push(this.consumeArg(r&&r[e+1]).tokens)}return n}expandOnce(t){const r=this.popToken();const n=r.text;const s=!r.noexpand?this._getExpansion(n):null;if(s==null||t&&s.unexpandable){if(t&&s==null&&n[0]==="\\"&&!this.isDefined(n)){throw new e("Undefined control sequence: "+n)}this.pushToken(r);return r}this.expansionCount++;if(this.expansionCount>this.settings.maxExpand){throw new e("Too many expansions: infinite loop or "+"need to increase maxExpand setting")}let o=s.tokens;const a=this.consumeArgs(s.numArgs,s.delimiters);if(s.numArgs){o=o.slice();for(let t=o.length-1;t>=0;--t){let r=o[t];if(r.text==="#"){if(t===0){throw new e("Incomplete placeholder at end of macro body",r)}r=o[--t];if(r.text==="#"){o.splice(t+1,1)}else if(/^[1-9]$/.test(r.text)){o.splice(t,2,...a[+r.text-1])}else{throw new e("Not a valid argument number",r)}}}}this.pushTokens(o);return o}expandAfterFuture(){this.expandOnce();return this.future()}expandNextToken(){for(;;){const e=this.expandOnce();if(e instanceof Rt){if(e.text==="\\relax"||e.treatAsRelax){this.stack.pop()}else{return this.stack.pop()}}}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new Rt(e)]):undefined}expandTokens(e){const t=[];const r=this.stack.length;this.pushTokens(e);while(this.stack.length>r){const e=this.expandOnce(true);if(e instanceof Rt){if(e.treatAsRelax){e.noexpand=false;e.treatAsRelax=false}t.push(this.stack.pop())}}return t}expandMacroAsText(e){const t=this.expandMacro(e);if(t){return t.map((e=>e.text)).join("")}else{return t}}_getExpansion(e){const t=this.macros.get(e);if(t==null){return t}const r=typeof t==="function"?t(this):t;if(typeof r==="string"){let e=0;if(r.indexOf("#")!==-1){const t=r.replace(/##/g,"");while(t.indexOf("#"+(e+1))!==-1){++e}}const t=new Jt(r,this.settings);const n=[];let s=t.lex();while(s.text!=="EOF"){n.push(s);s=t.lex()}n.reverse();const o={tokens:n,numArgs:e};return o}return r}isDefined(e){return this.macros.has(e)||Pt.hasOwnProperty(e)||V.math.hasOwnProperty(e)||V.text.hasOwnProperty(e)||ir.hasOwnProperty(e)}isExpandable(e){const t=this.macros.get(e);return t!=null?typeof t==="string"||typeof t==="function"||!t.unexpandable:Pt.hasOwnProperty(e)&&!Pt[e].primitive}}const ur=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];const cr=[];ur.forEach((e=>e.blocks.forEach((e=>cr.push(...e)))));function mr(e){for(let t=0;t<cr.length;t+=2){if(e>=cr[t]&&e<=cr[t+1]){return true}}return false}var pr={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"}};var dr={"á":"á","à":"à","ä":"ä","ǟ":"ǟ","ã":"ã","ā":"ā","ă":"ă","ắ":"ắ","ằ":"ằ","ẵ":"ẵ","ǎ":"ǎ","â":"â","ấ":"ấ","ầ":"ầ","ẫ":"ẫ","ȧ":"ȧ","ǡ":"ǡ","å":"å","ǻ":"ǻ","ḃ":"ḃ","ć":"ć","č":"č","ĉ":"ĉ","ċ":"ċ","ď":"ď","ḋ":"ḋ","é":"é","è":"è","ë":"ë","ẽ":"ẽ","ē":"ē","ḗ":"ḗ","ḕ":"ḕ","ĕ":"ĕ","ě":"ě","ê":"ê","ế":"ế","ề":"ề","ễ":"ễ","ė":"ė","ḟ":"ḟ","ǵ":"ǵ","ḡ":"ḡ","ğ":"ğ","ǧ":"ǧ","ĝ":"ĝ","ġ":"ġ","ḧ":"ḧ","ȟ":"ȟ","ĥ":"ĥ","ḣ":"ḣ","í":"í","ì":"ì","ï":"ï","ḯ":"ḯ","ĩ":"ĩ","ī":"ī","ĭ":"ĭ","ǐ":"ǐ","î":"î","ǰ":"ǰ","ĵ":"ĵ","ḱ":"ḱ","ǩ":"ǩ","ĺ":"ĺ","ľ":"ľ","ḿ":"ḿ","ṁ":"ṁ","ń":"ń","ǹ":"ǹ","ñ":"ñ","ň":"ň","ṅ":"ṅ","ó":"ó","ò":"ò","ö":"ö","ȫ":"ȫ","õ":"õ","ṍ":"ṍ","ṏ":"ṏ","ȭ":"ȭ","ō":"ō","ṓ":"ṓ","ṑ":"ṑ","ŏ":"ŏ","ǒ":"ǒ","ô":"ô","ố":"ố","ồ":"ồ","ỗ":"ỗ","ȯ":"ȯ","ȱ":"ȱ","ő":"ő","ṕ":"ṕ","ṗ":"ṗ","ŕ":"ŕ","ř":"ř","ṙ":"ṙ","ś":"ś","ṥ":"ṥ","š":"š","ṧ":"ṧ","ŝ":"ŝ","ṡ":"ṡ","ẗ":"ẗ","ť":"ť","ṫ":"ṫ","ú":"ú","ù":"ù","ü":"ü","ǘ":"ǘ","ǜ":"ǜ","ǖ":"ǖ","ǚ":"ǚ","ũ":"ũ","ṹ":"ṹ","ū":"ū","ṻ":"ṻ","ŭ":"ŭ","ǔ":"ǔ","û":"û","ů":"ů","ű":"ű","ṽ":"ṽ","ẃ":"ẃ","ẁ":"ẁ","ẅ":"ẅ","ŵ":"ŵ","ẇ":"ẇ","ẘ":"ẘ","ẍ":"ẍ","ẋ":"ẋ","ý":"ý","ỳ":"ỳ","ÿ":"ÿ","ỹ":"ỹ","ȳ":"ȳ","ŷ":"ŷ","ẏ":"ẏ","ẙ":"ẙ","ź":"ź","ž":"ž","ẑ":"ẑ","ż":"ż","Á":"Á","À":"À","Ä":"Ä","Ǟ":"Ǟ","Ã":"Ã","Ā":"Ā","Ă":"Ă","Ắ":"Ắ","Ằ":"Ằ","Ẵ":"Ẵ","Ǎ":"Ǎ","Â":"Â","Ấ":"Ấ","Ầ":"Ầ","Ẫ":"Ẫ","Ȧ":"Ȧ","Ǡ":"Ǡ","Å":"Å","Ǻ":"Ǻ","Ḃ":"Ḃ","Ć":"Ć","Č":"Č","Ĉ":"Ĉ","Ċ":"Ċ","Ď":"Ď","Ḋ":"Ḋ","É":"É","È":"È","Ë":"Ë","Ẽ":"Ẽ","Ē":"Ē","Ḗ":"Ḗ","Ḕ":"Ḕ","Ĕ":"Ĕ","Ě":"Ě","Ê":"Ê","Ế":"Ế","Ề":"Ề","Ễ":"Ễ","Ė":"Ė","Ḟ":"Ḟ","Ǵ":"Ǵ","Ḡ":"Ḡ","Ğ":"Ğ","Ǧ":"Ǧ","Ĝ":"Ĝ","Ġ":"Ġ","Ḧ":"Ḧ","Ȟ":"Ȟ","Ĥ":"Ĥ","Ḣ":"Ḣ","Í":"Í","Ì":"Ì","Ï":"Ï","Ḯ":"Ḯ","Ĩ":"Ĩ","Ī":"Ī","Ĭ":"Ĭ","Ǐ":"Ǐ","Î":"Î","İ":"İ","Ĵ":"Ĵ","Ḱ":"Ḱ","Ǩ":"Ǩ","Ĺ":"Ĺ","Ľ":"Ľ","Ḿ":"Ḿ","Ṁ":"Ṁ","Ń":"Ń","Ǹ":"Ǹ","Ñ":"Ñ","Ň":"Ň","Ṅ":"Ṅ","Ó":"Ó","Ò":"Ò","Ö":"Ö","Ȫ":"Ȫ","Õ":"Õ","Ṍ":"Ṍ","Ṏ":"Ṏ","Ȭ":"Ȭ","Ō":"Ō","Ṓ":"Ṓ","Ṑ":"Ṑ","Ŏ":"Ŏ","Ǒ":"Ǒ","Ô":"Ô","Ố":"Ố","Ồ":"Ồ","Ỗ":"Ỗ","Ȯ":"Ȯ","Ȱ":"Ȱ","Ő":"Ő","Ṕ":"Ṕ","Ṗ":"Ṗ","Ŕ":"Ŕ","Ř":"Ř","Ṙ":"Ṙ","Ś":"Ś","Ṥ":"Ṥ","Š":"Š","Ṧ":"Ṧ","Ŝ":"Ŝ","Ṡ":"Ṡ","Ť":"Ť","Ṫ":"Ṫ","Ú":"Ú","Ù":"Ù","Ü":"Ü","Ǘ":"Ǘ","Ǜ":"Ǜ","Ǖ":"Ǖ","Ǚ":"Ǚ","Ũ":"Ũ","Ṹ":"Ṹ","Ū":"Ū","Ṻ":"Ṻ","Ŭ":"Ŭ","Ǔ":"Ǔ","Û":"Û","Ů":"Ů","Ű":"Ű","Ṽ":"Ṽ","Ẃ":"Ẃ","Ẁ":"Ẁ","Ẅ":"Ẅ","Ŵ":"Ŵ","Ẇ":"Ẇ","Ẍ":"Ẍ","Ẋ":"Ẋ","Ý":"Ý","Ỳ":"Ỳ","Ÿ":"Ÿ","Ỹ":"Ỹ","Ȳ":"Ȳ","Ŷ":"Ŷ","Ẏ":"Ẏ","Ź":"Ź","Ž":"Ž","Ẑ":"Ẑ","Ż":"Ż","ά":"ά","ὰ":"ὰ","ᾱ":"ᾱ","ᾰ":"ᾰ","έ":"έ","ὲ":"ὲ","ή":"ή","ὴ":"ὴ","ί":"ί","ὶ":"ὶ","ϊ":"ϊ","ΐ":"ΐ","ῒ":"ῒ","ῑ":"ῑ","ῐ":"ῐ","ό":"ό","ὸ":"ὸ","ύ":"ύ","ὺ":"ὺ","ϋ":"ϋ","ΰ":"ΰ","ῢ":"ῢ","ῡ":"ῡ","ῠ":"ῠ","ώ":"ώ","ὼ":"ὼ","Ύ":"Ύ","Ὺ":"Ὺ","Ϋ":"Ϋ","Ῡ":"Ῡ","Ῠ":"Ῠ","Ώ":"Ώ","Ὼ":"Ὼ"};const hr=/^\d[\d.]*$/;class gr{constructor(e,t){this.mode="math";this.gullet=new lr(e,t,this.mode);this.settings=t;this.leftrightDepth=0;this.prevAtomType=""}expect(t,r=true){if(this.fetch().text!==t){throw new e(`Expected '${t}', got '${this.fetch().text}'`,this.fetch())}if(r){this.consume()}}consume(){this.nextToken=null}fetch(){if(this.nextToken==null){this.nextToken=this.gullet.expandNextToken()}return this.nextToken}switchMode(e){this.mode=e;this.gullet.switchMode(e)}parse(){this.gullet.beginGroup();const e=this.parseExpression(false);this.expect("EOF");this.gullet.endGroup();return e}static get endOfExpression(){return["}","\\endgroup","\\end","\\right","\\endtoggle","&"]}parseExpression(e,t){const r=[];while(true){if(this.mode==="math"){this.consumeSpaces()}const n=this.fetch();if(gr.endOfExpression.indexOf(n.text)!==-1){break}if(t&&n.text===t){break}if(e&&Pt[n.text]&&Pt[n.text].infix){break}const s=this.parseAtom(t);if(!s){break}else if(s.type==="internal"){continue}r.push(s);this.prevAtomType=s.type==="atom"?s.family:s.type}if(this.mode==="text"){this.formLigatures(r)}return this.handleInfixNodes(r)}handleInfixNodes(t){let r=-1;let n;for(let s=0;s<t.length;s++){if(t[s].type==="infix"){if(r!==-1){throw new e("only one infix operator per group",t[s].token)}r=s;n=t[s].replaceWith}}if(r!==-1&&n){let e;let s;const o=t.slice(0,r);const a=t.slice(r+1);if(o.length===1&&o[0].type==="ordgroup"){e=o[0]}else{e={type:"ordgroup",mode:this.mode,body:o}}if(a.length===1&&a[0].type==="ordgroup"){s=a[0]}else{s={type:"ordgroup",mode:this.mode,body:a}}let i;if(n==="\\\\abovefrac"){i=this.callFunction(n,[e,t[r],s],[])}else{i=this.callFunction(n,[e,s],[])}return[i]}else{return t}}handleSupSubscript(t){const r=this.fetch();const n=r.text;this.consume();this.consumeSpaces();const s=this.parseGroup(t);if(!s){throw new e("Expected group after '"+n+"'",r)}return s}formatUnsupportedCmd(e){const t=[];for(let r=0;r<e.length;r++){t.push({type:"textord",mode:"text",text:e[r]})}const r={type:"text",mode:this.mode,body:t};const n={type:"color",mode:this.mode,color:this.settings.errorColor,body:[r]};return n}parseAtom(t){const r=this.parseGroup("atom",t);if(this.mode==="text"){return r}let n;let s;while(true){this.consumeSpaces();const t=this.fetch();if(t.text==="\\limits"||t.text==="\\nolimits"){if(r&&r.type==="op"){const e=t.text==="\\limits";r.limits=e;r.alwaysHandleSupSub=true}else if(r&&r.type==="operatorname"&&r.alwaysHandleSupSub){const e=t.text==="\\limits";r.limits=e}else{throw new e("Limit controls must follow a math operator",t)}this.consume()}else if(t.text==="^"){if(n){throw new e("Double superscript",t)}n=this.handleSupSubscript("superscript")}else if(t.text==="_"){if(s){throw new e("Double subscript",t)}s=this.handleSupSubscript("subscript")}else if(t.text==="'"){if(n){throw new e("Double superscript",t)}const r={type:"textord",mode:this.mode,text:"\\prime"};const s=[r];this.consume();while(this.fetch().text==="'"){s.push(r);this.consume()}if(this.fetch().text==="^"){s.push(this.handleSupSubscript("superscript"))}n={type:"ordgroup",mode:this.mode,body:s}}else{break}}if(n||s){if(r&&r.type==="multiscript"&&!r.postscripts){r.postscripts={sup:n,sub:s};return r}else{return{type:"supsub",mode:this.mode,base:r,sup:n,sub:s}}}else{return r}}parseFunction(t,r){const n=this.fetch();const s=n.text;const o=Pt[s];if(!o){return null}this.consume();if(r&&r!=="atom"&&!o.allowedInArgument){throw new e("Got function '"+s+"' with no arguments"+(r?" as "+r:""),n)}else if(this.mode==="text"&&!o.allowedInText){throw new e("Can't use function '"+s+"' in text mode",n)}else if(this.mode==="math"&&o.allowedInMath===false){throw new e("Can't use function '"+s+"' in math mode",n)}const a=this.prevAtomType;const{args:i,optArgs:l}=this.parseArguments(s,o);this.prevAtomType=a;return this.callFunction(s,i,l,n,t)}callFunction(t,r,n,s,o){const a={funcName:t,parser:this,token:s,breakOnTokenText:o};const i=Pt[t];if(i&&i.handler){return i.handler(a,r,n)}else{throw new e(`No function handler for ${t}`)}}parseArguments(t,r){const n=r.numArgs+r.numOptionalArgs;if(n===0){return{args:[],optArgs:[]}}const s=[];const o=[];for(let a=0;a<n;a++){let n=r.argTypes&&r.argTypes[a];const i=a<r.numOptionalArgs;if(r.primitive&&n==null||r.type==="sqrt"&&a===1&&o[0]==null){n="primitive"}const l=this.parseGroupOfType(`argument to '${t}'`,n,i);if(i){o.push(l)}else if(l!=null){s.push(l)}else{throw new e("Null argument, please report this as a bug")}}return{args:s,optArgs:o}}parseGroupOfType(t,r,n){switch(r){case"color":return this.parseColorGroup(n);case"size":return this.parseSizeGroup(n);case"url":return this.parseUrlGroup(n);case"math":case"text":return this.parseArgumentGroup(n,r);case"hbox":{const e=this.parseArgumentGroup(n,"text");return e!=null?{type:"styling",mode:e.mode,body:[e],style:"text"}:null}case"raw":{const e=this.parseStringGroup("raw",n);return e!=null?{type:"raw",mode:"text",string:e.text}:null}case"primitive":{if(n){throw new e("A primitive argument cannot be optional")}const r=this.parseGroup(t);if(r==null){throw new e("Expected group as "+t,this.fetch())}return r}case"original":case null:case undefined:return this.parseArgumentGroup(n);default:throw new e("Unknown group type as "+t,this.fetch())}}consumeSpaces(){while(this.fetch().text===" "){this.consume()}}parseStringGroup(e,t){const r=this.gullet.scanArgument(t);if(r==null){return null}let n="";let s;while((s=this.fetch()).text!=="EOF"){n+=s.text;this.consume()}this.consume();r.text=n;return r}parseRegexGroup(t,r){const n=this.fetch();let s=n;let o="";let a;while((a=this.fetch()).text!=="EOF"&&t.test(o+a.text)){s=a;o+=s.text;this.consume()}if(o===""){throw new e("Invalid "+r+": '"+n.text+"'",n)}return n.range(s,o)}parseColorGroup(t){const r=this.parseStringGroup("color",t);if(r==null){return null}const n=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(r.text);if(!n){throw new e("Invalid color: '"+r.text+"'",r)}let s=n[0];if(/^[0-9a-f]{6}$/i.test(s)){s="#"+s}return{type:"color-token",mode:this.mode,color:s}}parseSizeGroup(t){let r;let n=false;this.gullet.consumeSpaces();if(!t&&this.gullet.future().text!=="{"){r=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size")}else{r=this.parseStringGroup("size",t)}if(!r){return null}if(!t&&r.text.length===0){r.text="0pt";n=true}const s=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(r.text);if(!s){throw new e("Invalid size: '"+r.text+"'",r)}const o={number:+(s[1]+s[2]),unit:s[3]};if(!Ie(o)){throw new e("Invalid unit: '"+o.unit+"'",r)}return{type:"size",mode:this.mode,value:o,isBlank:n}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13);const t=this.parseStringGroup("url",e);this.gullet.lexer.setCatcode("%",14);if(t==null){return null}const r=t.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:r}}parseArgumentGroup(e,t){const r=this.gullet.scanArgument(e);if(r==null){return null}const n=this.mode;if(t){this.switchMode(t)}this.gullet.beginGroup();const s=this.parseExpression(false,"EOF");this.expect("EOF");this.gullet.endGroup();const o={type:"ordgroup",mode:this.mode,loc:r.loc,body:s};if(t){this.switchMode(n)}return o}parseGroup(e,t){const r=this.fetch();const n=r.text;let s;if(n==="{"||n==="\\begingroup"||n==="\\toggle"){this.consume();const e=n==="{"?"}":n==="\\begingroup"?"\\endgroup":"\\endtoggle";this.gullet.beginGroup();const t=this.parseExpression(false,e);const o=this.fetch();this.expect(e);this.gullet.endGroup();s={type:o.text==="\\endtoggle"?"toggle":"ordgroup",mode:this.mode,loc:Ut.range(r,o),body:t,semisimple:n==="\\begingroup"||undefined}}else{s=this.parseFunction(t,e)||this.parseSymbol();if(s==null&&n[0]==="\\"&&!ir.hasOwnProperty(n)){s=this.formatUnsupportedCmd(n);this.consume()}}return s}formLigatures(e){let t=e.length-1;for(let r=0;r<t;++r){const n=e[r];const s=n.text;if(s==="-"&&e[r+1].text==="-"){if(r+1<t&&e[r+2].text==="-"){e.splice(r,3,{type:"textord",mode:"text",loc:Ut.range(n,e[r+2]),text:"---"});t-=2}else{e.splice(r,2,{type:"textord",mode:"text",loc:Ut.range(n,e[r+1]),text:"--"});t-=1}}if((s==="'"||s==="`")&&e[r+1].text===s){e.splice(r,2,{type:"textord",mode:"text",loc:Ut.range(n,e[r+1]),text:s+s});t-=1}}}parseSymbol(){const t=this.fetch();let r=t.text;if(/^\\verb[^a-zA-Z]/.test(r)){this.consume();let t=r.slice(5);const n=t.charAt(0)==="*";if(n){t=t.slice(1)}if(t.length<2||t.charAt(0)!==t.slice(-1)){throw new e(`\\verb assertion failed --\n                    please report what input caused this bug`)}t=t.slice(1,-1);return{type:"verb",mode:"text",body:t,star:n}}if(dr.hasOwnProperty(r[0])&&!V[this.mode][r[0]]){if(this.settings.strict&&this.mode==="math"){this.settings.reportNonstrict("unicodeTextInMathMode",`Accented Unicode text character "${r[0]}" used in `+`math mode`,t)}r=dr[r[0]]+r.substr(1)}const n=Yt.exec(r);if(n){r=r.substring(0,n.index);if(r==="i"){r="ı"}else if(r==="j"){r="ȷ"}}let s;if(V[this.mode][r]){const e=V[this.mode][r].group;const n=Ut.range(t);let o;if(U.hasOwnProperty(e)){const t=e;o={type:"atom",mode:this.mode,family:t,loc:n,text:r}}else{o={type:e,mode:this.mode,loc:n,text:r}}s=o}else if(!this.strict&&hr.test(r)){this.consume();return{type:"textord",mode:"math",loc:Ut.range(t),text:r}}else if(r.charCodeAt(0)>=128){if(this.settings.strict){if(!mr(r.charCodeAt(0))){this.settings.reportNonstrict("unknownSymbol",`Unrecognized Unicode character "${r[0]}"`+` (${r.charCodeAt(0)})`,t)}else if(this.mode==="math"){this.settings.reportNonstrict("unicodeTextInMathMode",`Unicode text character "${r[0]}" used in math mode`,t)}}s={type:"textord",mode:"text",loc:Ut.range(t),text:r}}else{return null}this.consume();if(n){for(let r=0;r<n[0].length;r++){const o=n[0][r];if(!pr[o]){throw new e(`Unknown accent ' ${o}'`,t)}const a=pr[o][this.mode];if(!a){throw new e(`Accent ${o} unsupported in ${this.mode} mode`,t)}s={type:"accent",mode:this.mode,loc:Ut.range(t),label:a,isStretchy:false,isShifty:true,base:s}}}return s}}const fr=function(t,r){if(!(typeof t==="string"||t instanceof String)){throw new TypeError("Temml can only parse string typed expression")}const n=new gr(t,r);delete n.gullet.macros.current["\\df@tag"];let s=n.parse();delete n.gullet.macros.current["\\current@color"];delete n.gullet.macros.current["\\color"];if(!(s.length>0&&s[0].type&&s[0].type==="array"&&s[0].addEqnNum)){if(n.gullet.macros.get("\\df@tag")){if(!r.displayMode){throw new e("\\tag works only in display equations")}n.gullet.feed("\\df@tag");s=[{type:"tag",mode:"text",body:s,tag:n.parse()}]}}return s};class br{constructor(e){this.style=e.style;this.color=e.color;this.font=e.font||"";this.fontFamily=e.fontFamily||"";this.fontWeight=e.fontWeight||"";this.fontShape=e.fontShape||"";this.maxSize=e.maxSize;this._fontMetrics=undefined}extend(e){const t={style:this.style,color:this.color,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize};for(const r in e){if(Object.prototype.hasOwnProperty.call(e,r)){t[r]=e[r]}}return new br(t)}withStyle(e){return this.extend({style:e})}incrementStyle(){return this.extend({style:Math.min(this.style+1,3)})}withColor(e){return this.extend({color:e})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}getColor(){return this.color}}function yr(e){const t={};let r=0;const n=e.getElementsByClassName("tml-tageqn");for(const e of n){const n=e.getElementsByClassName("tml-eqn");if(n.length>0){r+=1;n[0].textContent="("+r+")";n[0].id="tml-eqn-"+r}const s=e.getElementsByClassName("tml-label");if(s.length===0){continue}if(n.length>0){t[s[0].id]=String(r)}else{const r=e.getElementsByClassName("tml-tag");if(r.length>0){t[s[0].id]=r[0].textContent}}}const s=e.getElementsByClassName("tml-ref");[...s].forEach((e=>{let r=t[e.getAttribute("href").slice(1)];if(e.className.indexOf("tml-eqref")===-1){r=r.replace(/^\(/,"");r=r.replace(/\($/,"")}{if(r.charAt(0)!=="("){r="("+r}if(r.slice(-1)!==")"){r=r+")"}}e.textContent=r}))}let wr=function(e,t,r){t.textContent="";const n=vr(e,r).toNode();t.appendChild(n)};if(typeof document!=="undefined"){if(document.compatMode!=="CSS1Compat"){typeof console!=="undefined"&&console.warn("Warning: Temml doesn't work in quirks mode. Make sure your "+"website has a suitable doctype.");wr=function(){throw new e("Temml doesn't work in quirks mode.")}}}const xr=function(e,t){const r=vr(e,t).toMarkup();return r};const kr=function(e,t){const r=new h(t);return fr(e,r)};const Ar=function(t,r,n){if(n.throwOnError||!(t instanceof e)){throw t}const s=new S(["temml-error"],[new q(r)]);s.setAttribute("title",t.toString());s.setAttribute("style",`color:${n.errorColor}`);return s};const vr=function(e,t){const r=new h(t);try{const t=fr(e,r);const n=new br({style:r.displayMode?We.DISPLAY:We.TEXT,maxSize:r.maxSize});return be(t,e,n,r)}catch(t){return Ar(t,e,r)}};var Tr={version:.1,render:wr,renderToString:xr,postProcess:yr,ParseError:e,__parse:kr,__renderToMathMLTree:vr,__defineSymbol:_,__defineMacro:er};return Tr}();